<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adaptive Power Mapping System — Living Product Specification</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           CSS FOUNDATION — Design Tokens
           ======================================== */
        :root {
            --navy: #1a365d;
            --navy-light: #2d4a7c;
            --navy-dark: #0f2341;
            --orange: #ed8936;
            --orange-light: #f6ad55;
            --orange-dark: #dd6b20;
            --cream: #fffaf0;
            --cream-dark: #fef5e7;
            --white: #ffffff;
            --gray-100: #f7fafc;
            --gray-200: #edf2f7;
            --gray-300: #e2e8f0;
            --gray-400: #cbd5e0;
            --gray-500: #a0aec0;
            --gray-600: #718096;
            --gray-700: #4a5568;
            --gray-800: #2d3748;
            --success: #48bb78;
            --warning: #ecc94b;
            --danger: #fc8181;
            --amber: #f59e0b;
            --amber-light: #fbbf24;
            --amber-dark: #d97706;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1), 0 6px 10px rgba(0,0,0,0.08);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.15);
            --radius: 12px;
            --radius-lg: 20px;
            --transition: all 0.3s ease;
            /* Animation timing */
            --duration-instant: 0ms;
            --duration-quick: 150ms;
            --duration-normal: 300ms;
            --duration-slow: 500ms;
            --duration-deliberate: 800ms;
            --spring-bouncy: cubic-bezier(0.34, 1.56, 0.64, 1);
            --spring-gentle: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
            /* Decision tree colors */
            --dt-bg: #0d1b2a;
            --dt-line: #415a77;
            --dt-green: #48bb78;
            --dt-blue: #63b3ed;
            --dt-orange: #ed8936;
            --dt-red: #fc8181;
            --dt-purple: #b794f4;
            --dt-yellow: #ecc94b;
            --dt-teal: #4fd1c5;
            /* Vibrant extended palette */
            --purple: #7c3aed;
            --purple-dark: #6b21a8;
            --teal: #14b8a6;
            --teal-dark: #0d9488;
            --magenta: #ec4899;
            --electric-blue: #3b82f6;
            --indigo: #6366f1;
            --section-accent: var(--orange);
        }

        /* ========================================
           RESET & BASE
           ======================================== */
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--cream);
            color: var(--gray-800);
            line-height: 1.7;
            font-size: 16px;
            overflow-x: hidden;
        }
        h1, h2, h3, h4 { font-family: 'Playfair Display', Georgia, serif; color: var(--navy); line-height: 1.3; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

        /* ========================================
           SCROLL REVEAL SYSTEM
           ======================================== */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity var(--duration-deliberate) var(--spring-gentle),
                        transform var(--duration-deliberate) var(--spring-bouncy);
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .reveal-delay-1 { transition-delay: 100ms; }
        .reveal-delay-2 { transition-delay: 200ms; }
        .reveal-delay-3 { transition-delay: 300ms; }
        .reveal-delay-4 { transition-delay: 400ms; }

        /* ========================================
           PHASE F — STAGGERED CARD REVEALS
           ======================================== */
        .card-grid.reveal {
            opacity: 1;
            transform: none;
            transition: none;
        }
        .card-grid .card.reveal {
            opacity: 0;
            transform: translateY(40px);
            transition:
                opacity var(--duration-deliberate) var(--spring-gentle),
                transform var(--duration-deliberate) var(--spring-bouncy);
        }
        .card-grid .card.reveal.visible {
            opacity: 1;
            transform: translateY(0);
            transition-delay: calc(var(--stagger-index, 0) * 100ms);
        }

        /* ========================================
           HERO SECTION
           ======================================== */
        .hero {
            background: linear-gradient(-45deg, #0f0c29, #302b63, #24243e, #1a365d, #0d3b4c, #1a1a4e, #1e1b4b);
            background-size: 600% 600%;
            animation: heroShift 25s ease infinite;
            color: var(--white);
            padding: 80px 0 60px;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(ellipse at 20% 50%, rgba(124,58,237,0.3) 0%, transparent 55%),
                radial-gradient(ellipse at 80% 20%, rgba(20,184,166,0.25) 0%, transparent 50%),
                radial-gradient(ellipse at 60% 80%, rgba(99,102,241,0.2) 0%, transparent 45%),
                radial-gradient(ellipse at 10% 80%, rgba(236,72,153,0.12) 0%, transparent 40%);
            pointer-events: none;
            z-index: 0;
        }
        .hero .container { position: relative; z-index: 2; }
        .hero-empire {
            font-family: 'Inter', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            color: var(--orange-light);
            text-transform: lowercase;
            margin-bottom: 16px;
            opacity: 0;
            animation: fadeInUp 0.6s var(--spring-gentle) 0.2s forwards;
        }
        .hero h1 {
            font-size: clamp(2rem, 5vw, 3.2rem);
            color: var(--white);
            margin-bottom: 12px;
        }
        .hero-subtitle {
            font-size: 1.1rem;
            color: var(--gray-400);
            margin-bottom: 28px;
            opacity: 0;
            animation: fadeInUp 0.6s var(--spring-gentle) 0.6s forwards;
        }
        .hero-meta {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            font-size: 0.88rem;
            color: var(--gray-500);
            margin-bottom: 32px;
            opacity: 0;
            animation: fadeInUp 0.6s var(--spring-gentle) 0.8s forwards;
        }
        .hero-meta span {
            padding: 6px 16px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 20px;
        }
        .hero-intro-box {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            padding: 28px 32px;
            font-size: 0.95rem;
            line-height: 1.8;
            color: var(--gray-300);
            opacity: 0;
            animation: fadeInUp 0.8s var(--spring-gentle) 1s forwards;
        }
        .hero-intro-box strong { color: var(--white); }
        .hero-intro-box em { color: var(--orange-light); }

        /* Hero floating particles — varied sizes + glow */
        .hero-particles-layer { position: absolute; inset: 0; z-index: 1; pointer-events: none; }
        .hero-particle {
            position: absolute;
            width: 4px; height: 4px;
            background: var(--orange);
            border-radius: 50%;
            opacity: 0;
            animation: particleDrift 18s infinite;
        }
        .hero-particle.lg { width: 7px; height: 7px; background: var(--amber-light); box-shadow: 0 0 8px rgba(251,191,36,0.4); }
        .hero-particle.sm { width: 2px; height: 2px; background: rgba(255,255,255,0.5); }
        .hero-particle.glow { width: 5px; height: 5px; background: var(--teal); box-shadow: 0 0 12px rgba(20,184,166,0.5); }
        .hero-particle:nth-child(1)  { left: 8%;  top: 15%; animation-delay: 0s; animation-duration: 22s; }
        .hero-particle:nth-child(2)  { left: 22%; top: 65%; animation-delay: 2s; animation-duration: 26s; }
        .hero-particle:nth-child(3)  { left: 50%; top: 25%; animation-delay: 5s; animation-duration: 18s; }
        .hero-particle:nth-child(4)  { left: 72%; top: 58%; animation-delay: 8s; animation-duration: 24s; }
        .hero-particle:nth-child(5)  { left: 40%; top: 82%; animation-delay: 1s; animation-duration: 28s; }
        .hero-particle:nth-child(6)  { left: 88%; top: 20%; animation-delay: 4s; animation-duration: 20s; }
        .hero-particle:nth-child(7)  { left: 15%; top: 45%; animation-delay: 7s; animation-duration: 30s; }
        .hero-particle:nth-child(8)  { left: 65%; top: 12%; animation-delay: 3s; animation-duration: 25s; }
        .hero-particle:nth-child(9)  { left: 35%; top: 55%; animation-delay: 6s; animation-duration: 16s; }
        .hero-particle:nth-child(10) { left: 78%; top: 78%; animation-delay: 0s; animation-duration: 32s; }
        .hero-particle:nth-child(11) { left: 5%;  top: 88%; animation-delay: 9s; animation-duration: 19s; }
        .hero-particle:nth-child(12) { left: 55%; top: 42%; animation-delay: 2s; animation-duration: 27s; }
        .hero-particle:nth-child(13) { left: 30%; top: 10%; animation-delay: 4s; animation-duration: 23s; }
        .hero-particle:nth-child(14) { left: 92%; top: 55%; animation-delay: 6s; animation-duration: 21s; }
        .hero-particle:nth-child(15) { left: 60%; top: 90%; animation-delay: 1s; animation-duration: 29s; }
        @keyframes particleDrift {
            0% { opacity: 0; transform: translateY(0) translateX(0) rotate(0deg); }
            10% { opacity: 0.4; }
            30% { opacity: 0.2; transform: translateY(-40px) translateX(20px) rotate(45deg); }
            60% { opacity: 0.35; transform: translateY(-90px) translateX(-15px) rotate(90deg); }
            90% { opacity: 0.15; }
            100% { opacity: 0; transform: translateY(-160px) translateX(10px) rotate(180deg); }
        }

        /* Character-split hero title */
        .hero-title .char {
            display: inline-block;
            opacity: 0;
            animation: charReveal 0.6s var(--spring-bouncy) forwards;
        }
        .hero-title .char-space { display: inline-block; width: 0.3em; }

        /* Typewriter subtitle */
        .hero-subtitle .typewriter-cursor {
            display: inline-block;
            width: 2px;
            height: 1.1em;
            background: var(--orange-light);
            margin-left: 2px;
            vertical-align: text-bottom;
            animation: typewriterBlink 0.8s step-end infinite;
        }

        /* Breathing accent bar below hero */
        .hero-accent {
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, var(--orange) 30%, var(--amber) 50%, var(--orange) 70%, transparent 100%);
            animation: accentBreathe 4s ease-in-out infinite;
        }
        @keyframes accentBreathe {
            0%, 100% { opacity: 0.5; transform: scaleX(0.9); }
            50% { opacity: 1; transform: scaleX(1); }
        }

        /* Brain emoji pulse */
        .cognitive-lineage { animation: brainPulse 6s ease-in-out infinite; }
        @keyframes brainPulse {
            0%, 85%, 100% { transform: scale(1); }
            90% { transform: scale(1.15); }
            95% { transform: scale(1); }
        }

        /* ========================================
           PHASE F — MICRO-INTERACTIONS & SWARM SVG
           ======================================== */
        /* Three-step spring button press */
        .feedback-btn:active {
            transform: scale(0.93);
            transition: transform 0.1s ease;
        }
        .feedback-btn { will-change: transform; }

        /* Brain emoji hover enhanced */
        .cognitive-lineage:hover {
            transform: scale(1.2);
            filter: drop-shadow(0 0 6px rgba(237,137,54,0.4));
            animation-play-state: paused;
        }

        /* Swarm container reveal wrapper */
        .swarm-container.reveal { opacity: 1; transform: none; transition: none; }
        .swarm-container.reveal .swarm-svg { opacity: 0; transition: opacity 0.6s ease; }
        .swarm-container.reveal.visible .swarm-svg { opacity: 1; }

        /* Swarm edge flowing dashes */
        .swarm-container.reveal.visible .swarm-svg > g:first-child line {
            stroke-dasharray: 8 6;
            animation: swarmFlowDash 1.8s linear infinite;
        }

        /* Swarm node sequential pulse on reveal */
        .swarm-container.reveal.visible .swarm-svg g:nth-child(2) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 0s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(3) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 0.3s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(4) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 0.6s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(5) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 0.9s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(6) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 1.2s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(7) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 1.5s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(8) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 1.8s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(9) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 2.1s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(10) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 2.4s infinite; }
        .swarm-container.reveal.visible .swarm-svg g:nth-child(11) circle:first-of-type { animation: gradientPulse 3.5s ease-in-out 2.7s infinite; }

        /* Swarm node hover highlight */
        .swarm-svg g:nth-child(n+2):hover circle:first-of-type { filter: brightness(1.35); transition: filter 0.2s ease; }

        /* Entry card hover enhanced */
        .entry-card:hover {
            transform: translateY(-6px) scale(1.02);
            border-color: var(--section-accent, var(--orange-light));
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
        }

        /* Split card hover */
        .split-card { transition: transform 0.3s var(--spring-bouncy), box-shadow 0.3s ease; }
        .split-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); }

        /* Feedback zone hover lift */
        .feedback-zone:hover:not(:focus-within) { transform: scale(1.002); }

        /* Enhanced card interactions */
        .card { will-change: transform, box-shadow; }
        .card:active { transform: translateY(-2px) scale(0.98); transition: transform 0.1s ease; }

        /* Quote block entrance */
        .quote-block { transition: transform 0.5s var(--spring-bouncy), box-shadow 0.3s ease; position: relative; }
        .quote-block:hover { transform: translateX(4px); box-shadow: var(--shadow-lg); }

        /* ========================================
           PHASE F — QUOTE BLOCK ENTRANCE
           ======================================== */
        .quote-block.reveal::before { opacity: 0; transform: scale(0.3) rotate(-15deg); animation: none; }
        .quote-block.reveal.visible::before { animation: quoteMarkReveal 0.8s var(--spring-bouncy) 0.2s forwards; }
        .quote-block.reveal p { opacity: 0; transform: translateX(-10px); transition: opacity 0.6s ease 0.4s, transform 0.6s var(--spring-bouncy) 0.4s; }
        .quote-block.reveal.visible p { opacity: 1; transform: translateX(0); }
        .quote-block.reveal .quote-attribution { opacity: 0; transition: opacity 0.5s ease 0.65s; }
        .quote-block.reveal.visible .quote-attribution { opacity: 1; }
        /* Hover: left accent bar slides in */
        .quote-block::after {
            content: ''; position: absolute; left: 0; top: 20%; height: 60%; width: 3px;
            background: var(--orange-light); border-radius: 0 2px 2px 0;
            transform: scaleY(0); transform-origin: top; transition: transform 0.4s var(--spring-bouncy);
        }
        .quote-block:hover::after { transform: scaleY(1); }

        /* Section number badge pop */
        .section-number { transition: transform 0.3s var(--spring-bouncy); }
        .section-number:hover { transform: scale(1.08); }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes heroShift {
            0%   { background-position: 0% 50%; }
            50%  { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes borderGlow {
            0%   { background-position: 0% 0%; }
            50%  { background-position: 300% 300%; }
            100% { background-position: 0% 0%; }
        }
        @keyframes shimmer {
            0%   { background-position: 200% 0%; }
            100% { background-position: -200% 0%; }
        }
        @keyframes gradientPulse {
            0%   { opacity: 1; transform: scale(1); }
            50%  { opacity: 0.7; transform: scale(1.04); }
            100% { opacity: 1; transform: scale(1); }
        }
        @keyframes rippleExpand {
            0%   { transform: scale(0); opacity: 0.6; }
            100% { transform: scale(3); opacity: 0; }
        }
        @keyframes drawBorder {
            0%   { clip-path: inset(0 100% 100% 0); }
            25%  { clip-path: inset(0 0 100% 0); }
            50%  { clip-path: inset(0 0 0 0); }
            100% { clip-path: inset(0 0 0 0); }
        }
        @keyframes pathDraw {
            from { stroke-dashoffset: var(--path-length, 1000); }
            to { stroke-dashoffset: 0; }
        }
        @keyframes flowParticle {
            0%   { offset-distance: 0%; opacity: 0; }
            10%  { opacity: 1; }
            90%  { opacity: 1; }
            100% { offset-distance: 100%; opacity: 0; }
        }
        @keyframes charReveal {
            from { opacity: 0; transform: translateY(30px) rotate(5deg); filter: blur(4px); }
            to { opacity: 1; transform: translateY(0) rotate(0deg); filter: blur(0); }
        }
        @keyframes typewriterBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        @keyframes sectionFadeSlide {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes quoteMarkReveal {
            from { opacity: 0; transform: scale(0.3) rotate(-15deg); }
            to { opacity: 0.3; transform: scale(1) rotate(0deg); }
        }
        @keyframes stepLineGrow {
            from { transform: scaleY(0); }
            to { transform: scaleY(1); }
        }
        @keyframes nodeRipple {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(2.5); opacity: 0; }
        }
        @keyframes swarmFlowDash {
            from { stroke-dashoffset: 20; }
            to { stroke-dashoffset: 0; }
        }

        /* ========================================
           SECTIONS
           ======================================== */
        section { padding: 56px 0; position: relative; }
        section:nth-child(even) { background: var(--cream-dark); }
        .section-header { text-align: center; margin-bottom: 40px; }
        .section-number {
            display: inline-block;
            background: linear-gradient(135deg, var(--orange), var(--orange-dark));
            color: var(--white); font-weight: 700; font-size: 0.875rem;
            padding: 5px 14px; border-radius: 20px; margin-bottom: 12px;
            font-family: 'Inter', sans-serif;
        }
        .section-header h2 { font-size: clamp(1.6rem, 3.5vw, 2.25rem); margin-bottom: 10px; }
        .section-header p { color: var(--gray-600); max-width: 700px; margin: 0 auto; font-size: 1.05rem; }

        /* ========================================
           PHASE F — SECTION HEADER ENTRANCE
           ======================================== */
        .section-header.reveal { opacity: 1; transform: none; transition: none; }
        .section-header.reveal .section-number {
            display: inline-block; opacity: 0; transform: translateY(-20px) scale(0.8);
            transition: opacity 0.4s ease 0s, transform 0.5s var(--spring-bouncy) 0s;
        }
        .section-header.reveal.visible .section-number { opacity: 1; transform: translateY(0) scale(1); }
        .section-header.reveal h2 {
            opacity: 0; transform: translateY(15px);
            transition: opacity 0.5s ease 0.15s, transform 0.5s var(--spring-bouncy) 0.15s;
        }
        .section-header.reveal.visible h2 { opacity: 1; transform: translateY(0); }
        .section-header.reveal p {
            opacity: 0; transform: translateY(10px);
            transition: opacity 0.5s ease 0.3s, transform 0.5s ease 0.3s;
        }
        .section-header.reveal.visible p { opacity: 1; transform: translateY(0); }

        /* ========================================
           CARDS
           ======================================== */
        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 24px;
            transition: transform 0.4s var(--spring-bouncy), box-shadow 0.3s ease;
            border: 1px solid transparent;
            position: relative;
            z-index: 1;
        }
        .card::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: inherit;
            background: linear-gradient(45deg, var(--amber), var(--purple), var(--teal), var(--electric-blue), var(--amber));
            background-size: 300% 300%;
            animation: borderGlow 4s ease infinite;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        .card:hover { box-shadow: var(--shadow-xl); transform: translateY(-6px); }
        .card:hover::before { opacity: 1; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card-grid.two-col { grid-template-columns: repeat(2, 1fr); }
        @media (max-width: 768px) { .card-grid.two-col { grid-template-columns: 1fr; } }
        .card-header { display: flex; align-items: center; gap: 14px; margin-bottom: 14px; }
        .card-icon {
            width: 48px; height: 48px;
            background: linear-gradient(135deg, var(--navy), var(--navy-light));
            border-radius: var(--radius);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.25rem; flex-shrink: 0;
        }
        .card h3 { font-size: 1.1rem; margin-bottom: 2px; }
        .card h4 { font-family: 'Inter', sans-serif; font-size: 0.95rem; }
        .card-tag {
            font-size: 0.7rem; font-weight: 600; color: var(--orange);
            text-transform: uppercase; letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
        }
        .card p { font-size: 0.95rem; color: var(--gray-700); }
        .card ul { font-size: 0.95rem; color: var(--gray-700); padding-left: 20px; }
        .card ul li { margin-bottom: 4px; }

        /* ========================================
           QUOTE BLOCK
           ======================================== */
        .quote-block {
            background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
            color: var(--white);
            border-radius: var(--radius-lg);
            padding: 36px 40px;
            position: relative;
            margin: 28px 0;
        }
        .quote-block::before {
            content: '\201C'; position: absolute; top: 12px; left: 24px;
            font-size: 5rem; font-family: 'Playfair Display', serif;
            color: var(--orange); opacity: 0.3; line-height: 1;
        }
        .quote-block p { font-size: 1.15rem; font-style: italic; line-height: 1.8; position: relative; z-index: 1; }
        .quote-attribution { margin-top: 16px; font-weight: 600; color: var(--orange-light); }

        /* ========================================
           COGNITIVE LINEAGE TOOLTIP
           ======================================== */
        .cognitive-lineage {
            position: relative;
            cursor: help;
            display: inline;
        }
        .cognitive-lineage .tooltip {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: #0a1628;
            color: var(--cream);
            padding: 16px 20px;
            border: 1px solid rgba(237, 137, 54, 0.25);
            border-radius: 12px;
            font-size: 0.82rem;
            font-style: normal;
            line-height: 1.7;
            width: 340px;
            max-width: 90vw;
            z-index: 100;
            pointer-events: none;
            transition: opacity 0.2s, visibility 0.2s;
            box-shadow: 0 4px 16px rgba(0,0,0,0.4), 0 12px 48px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05);
        }
        .cognitive-lineage .tooltip::before {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 0;
            right: 0;
            height: 12px;
        }
        .cognitive-lineage .tooltip::after {
            content: ''; position: absolute; top: 100%; left: 50%;
            transform: translateX(-50%); border: 8px solid transparent;
            border-top-color: #0a1628;
        }
        .cognitive-lineage:hover .tooltip,
        .cognitive-lineage:focus .tooltip {
            visibility: visible;
            opacity: 1;
            pointer-events: auto;
        }
        .tooltip-header { font-weight: 600; color: var(--orange-light); margin-bottom: 6px; display: block; }
        .tooltip-source { font-size: 0.75rem; color: var(--gray-400); margin-top: 6px; padding-top: 6px; border-top: 1px solid rgba(255,255,255,0.1); display: block; }

        /* ========================================
           CALLOUT
           ======================================== */
        .callout {
            background: rgba(237,137,54,0.06);
            border-left: 4px solid var(--orange);
            border-radius: 0 var(--radius) var(--radius) 0;
            padding: 16px 20px;
            margin: 16px 0;
            font-size: 0.95rem;
        }
        .callout strong { color: var(--navy); }

        /* ========================================
           FEEDBACK ZONE — High Contrast Living Amber
           ======================================== */
        .feedback-zone {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(245,158,11,0.14) 0%, rgba(251,191,36,0.08) 100%);
            border: 3px solid rgba(245,158,11,0.4);
            border-left: 5px solid var(--amber);
            border-radius: var(--radius-lg);
            padding: 28px 28px 24px;
            margin-top: 36px;
            z-index: 1;
            transition: border-color 0.3s ease, box-shadow 0.4s ease, transform 0.4s var(--spring-bouncy), background 0.3s ease;
        }
        .feedback-zone::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent 20%, rgba(245,158,11,0.05) 50%, transparent 80%);
            background-size: 200% 100%;
            animation: shimmer 12s ease infinite;
            pointer-events: none;
            z-index: 0;
            border-radius: inherit;
        }
        .feedback-zone:focus-within {
            border-color: var(--amber);
            box-shadow:
                0 0 0 4px rgba(245,158,11,0.2),
                0 0 40px rgba(245,158,11,0.1),
                0 8px 32px rgba(245,158,11,0.08);
            transform: scale(1.003);
        }
        .feedback-zone.submitted {
            background: linear-gradient(135deg, rgba(72,187,120,0.12) 0%, rgba(72,187,120,0.06) 100%);
            border-color: var(--success);
            border-left-color: var(--success);
        }
        .feedback-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; position: relative; z-index: 2; }
        .feedback-header h4 {
            font-family: 'Inter', sans-serif; font-size: 1.1rem;
            font-weight: 700; color: var(--amber-dark); letter-spacing: 0.02em;
        }
        .feedback-prompt { color: var(--gray-600); margin-bottom: 12px; font-style: italic; font-size: 0.95rem; position: relative; z-index: 2; }
        .feedback-textarea {
            width: 100%; min-height: 100px; padding: 14px;
            border: 2px solid var(--gray-300); border-radius: var(--radius);
            font-family: 'Inter', sans-serif; font-size: 0.95rem;
            line-height: 1.6; resize: vertical; transition: var(--transition);
            background: var(--white); position: relative; z-index: 2;
        }
        .feedback-textarea:focus {
            outline: none; border-color: var(--amber);
            box-shadow: 0 0 0 4px rgba(245,158,11,0.15);
        }
        .feedback-actions { display: flex; align-items: center; gap: 12px; margin-top: 12px; position: relative; z-index: 2; }
        .feedback-btn {
            padding: 10px 24px;
            background: linear-gradient(135deg, var(--amber), var(--amber-dark));
            color: var(--white); border: none; border-radius: 8px;
            font-family: 'Inter', sans-serif; font-weight: 600; font-size: 0.9rem;
            cursor: pointer; transition: all 0.3s var(--spring-bouncy);
        }
        .feedback-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(245,158,11,0.3); }
        .feedback-status { font-size: 0.85rem; color: var(--success); }

        /* ========================================
           SPLIT GRID (Problem / Opportunity)
           ======================================== */
        .split-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 24px 0; }
        @media (max-width: 768px) { .split-grid { grid-template-columns: 1fr; } }
        .split-card {
            background: var(--white); border-radius: var(--radius-lg);
            padding: 28px; box-shadow: var(--shadow);
        }
        .split-card.problem { border-top: 4px solid var(--danger); }
        .split-card.opportunity { border-top: 4px solid var(--success); }
        .split-card-header {
            font-family: 'Inter', sans-serif; font-weight: 700; font-size: 0.85rem;
            text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 16px; padding-bottom: 8px;
            border-bottom: 1px solid var(--gray-200);
        }
        .split-card-header.problem { color: var(--danger); }
        .split-card-header.opportunity { color: var(--success); }
        .split-card ul { padding-left: 18px; font-size: 0.95rem; color: var(--gray-700); }
        .split-card li { margin-bottom: 10px; line-height: 1.6; }

        /* ========================================
           JOURNEY STEPS
           ======================================== */
        .journey-steps { display: flex; flex-direction: column; gap: 0; margin: 24px 0; }
        .journey-step {
            display: flex; gap: 20px; padding: 24px 0;
            border-bottom: 1px solid var(--gray-200);
        }
        .journey-step:last-child { border-bottom: none; }

        /* ========================================
           PHASE F — JOURNEY STEP SEQUENTIAL REVEALS
           ======================================== */
        .journey-steps.reveal { opacity: 1; transform: none; transition: none; }
        .journey-steps { position: relative; }
        .journey-step.reveal {
            opacity: 0; transform: translateX(30px);
            transition: opacity var(--duration-slow) var(--spring-gentle), transform var(--duration-slow) var(--spring-bouncy);
        }
        .journey-step.reveal.visible { opacity: 1; transform: translateX(0); }
        .journey-step.reveal .step-number {
            opacity: 0; transform: scale(0.5);
            transition: opacity 0.4s ease 0.1s, transform 0.5s var(--spring-bouncy) 0.1s;
        }
        .journey-step.reveal.visible .step-number { opacity: 1; transform: scale(1); }
        .journey-step.reveal .step-content {
            opacity: 0; transform: translateX(20px);
            transition: opacity 0.5s ease 0.25s, transform 0.5s var(--spring-bouncy) 0.25s;
        }
        .journey-step.reveal.visible .step-content { opacity: 1; transform: translateX(0); }

        .step-number {
            width: 44px; height: 44px; flex-shrink: 0;
            background: linear-gradient(135deg, var(--navy), var(--navy-light));
            color: var(--white); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 1.1rem; font-family: 'Inter', sans-serif;
        }
        .step-content h3 { font-size: 1.05rem; margin-bottom: 4px; }
        .step-content h4 { font-size: 1rem; margin-bottom: 4px; }
        .step-content p { font-size: 0.95rem; color: var(--gray-700); }
        .subsection-desc { color: var(--gray-600); font-size: 1rem; margin-bottom: 20px; font-style: italic; }

        /* ========================================
           TIME MAP — Flowing SVG Visualization
           ======================================== */
        .time-map {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 30%, #0f0c29 70%, #1a1a3e 100%);
            border-radius: var(--radius-lg);
            padding: 40px 24px 48px;
            margin: 32px 0;
            position: relative;
            overflow: hidden;
        }
        .time-map::before {
            content: '';
            position: absolute; inset: 0;
            background: radial-gradient(ellipse at 50% 50%, rgba(124,58,237,0.08) 0%, transparent 70%);
            pointer-events: none;
        }
        .time-map h3 { color: var(--white); text-align: center; margin-bottom: 8px; font-size: 1.3rem; position: relative; z-index: 2; }
        .time-map-subtitle { color: var(--gray-400); text-align: center; margin-bottom: 24px; font-size: 0.9rem; position: relative; z-index: 2; }
        .time-map-svg { width: 100%; display: block; position: relative; z-index: 2; }
        /* SVG path animation for the flowing connection */
        .time-path-bg { stroke: rgba(255,255,255,0.06); stroke-width: 3; fill: none; }
        .time-path-flow {
            fill: none; stroke-width: 3; stroke-linecap: round;
            stroke-dasharray: 12 8;
            animation: swarmFlowDash 1.5s linear infinite;
        }
        .time-path-glow {
            fill: none; stroke-width: 6; stroke-linecap: round;
            opacity: 0.15; filter: blur(4px);
        }
        /* Time node circles with ripple */
        .time-node-group { cursor: pointer; }
        .time-node-group:hover .time-node-ring { opacity: 0.4; }
        .time-node-ring {
            fill: none; stroke-width: 2; opacity: 0;
            transition: opacity 0.3s ease;
        }
        .time-node-ripple {
            fill: none; stroke-width: 1.5; opacity: 0;
        }
        .time-node-group.present .time-node-ripple {
            animation: nodeRipple 3s ease-out infinite;
        }
        .time-node-group.present .time-node-ripple:nth-child(2) { animation-delay: 1s; }
        .time-node-group.present .time-node-ripple:nth-child(3) { animation-delay: 2s; }
        .time-node-emoji { font-size: 22px; pointer-events: none; }
        .time-node-label { fill: var(--white); font-family: 'Inter', sans-serif; font-weight: 600; font-size: 13px; }
        .time-node-date { fill: var(--gray-400); font-family: 'Inter', sans-serif; font-size: 10px; }
        .time-node-desc { fill: var(--gray-500); font-family: 'Inter', sans-serif; font-size: 9px; }
        /* Floating particles along path */
        .time-particle {
            r: 2.5; opacity: 0;
            animation: flowParticle 5s linear infinite;
        }
        .time-particle:nth-child(2) { animation-delay: 1.25s; r: 2; }
        .time-particle:nth-child(3) { animation-delay: 2.5s; r: 3; }
        .time-particle:nth-child(4) { animation-delay: 3.75s; r: 1.5; }

        /* ========================================
           PORTAL SECTION
           ======================================== */
        .portal-section { background: var(--cream); padding: 56px 0; }
        .portal-welcome { text-align: center; margin-bottom: 40px; }
        .portal-welcome h2 { margin-bottom: 16px; }
        .welcome-text { color: var(--gray-700); max-width: 700px; margin: 0 auto; font-size: 1.02rem; line-height: 1.8; }
        .entry-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 32px 0; }
        @media (max-width: 768px) { .entry-cards { grid-template-columns: 1fr; } }
        .entry-card {
            background: var(--white); border-radius: var(--radius-lg);
            padding: 24px; text-align: center; box-shadow: var(--shadow);
            transition: all 0.3s var(--spring-bouncy); border: 1px solid transparent;
            cursor: pointer;
        }
        .entry-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); border-color: var(--orange-light); }
        .entry-time {
            display: inline-block; background: var(--navy);
            color: var(--white); font-weight: 700; font-size: 0.8rem;
            padding: 4px 12px; border-radius: 12px; margin-bottom: 12px;
            font-family: 'Inter', sans-serif;
        }
        .entry-card h4 { margin-bottom: 8px; }
        .entry-card p { font-size: 0.9rem; color: var(--gray-600); }

        /* Different Block */
        .different-block {
            background: var(--white); border-radius: var(--radius-lg);
            padding: 32px; margin: 32px 0; box-shadow: var(--shadow);
        }
        .different-block h3 { margin-bottom: 16px; }
        .different-block p { font-size: 0.95rem; color: var(--gray-700); margin-bottom: 12px; line-height: 1.7; }
        .unnamed-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
        @media (max-width: 768px) { .unnamed-grid { grid-template-columns: 1fr; } }
        .unnamed-item {
            display: flex; gap: 12px; align-items: center;
            padding: 12px 16px; background: var(--cream);
            border-radius: var(--radius); font-size: 0.9rem;
        }
        .swap-arrow { color: var(--orange); font-weight: 700; font-size: 1.2rem; flex-shrink: 0; }
        .label-traditional { display: block; color: var(--gray-500); text-decoration: line-through; font-size: 0.85rem; }
        .label-ours { display: block; color: var(--navy); font-weight: 600; }

        /* Ask Block */
        .ask-block {
            background: linear-gradient(135deg, rgba(237,137,54,0.06) 0%, rgba(237,137,54,0.02) 100%);
            border: 1px solid rgba(237,137,54,0.15);
            border-radius: var(--radius-lg);
            padding: 32px; margin: 32px 0;
        }
        .ask-block h3 { margin-bottom: 12px; }
        .ask-block p { font-size: 0.95rem; color: var(--gray-700); margin-bottom: 16px; }
        .ask-list { list-style: none; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        @media (max-width: 768px) { .ask-list { grid-template-columns: 1fr; } }
        .ask-list li { display: flex; gap: 10px; align-items: center; font-size: 0.95rem; padding: 8px 12px; background: var(--white); border-radius: 8px; }

        /* ========================================
           GLOSSARY PANEL
           ======================================== */
        .glossary-fab {
            position: fixed; bottom: 24px; right: 24px; z-index: 9998;
            width: 52px; height: 52px; border-radius: 50%;
            background: linear-gradient(135deg, var(--navy), var(--navy-light));
            color: var(--white); border: none; font-size: 1.4rem;
            cursor: pointer; box-shadow: var(--shadow-lg);
            transition: all 0.3s var(--spring-bouncy);
            display: flex; align-items: center; justify-content: center;
        }
        .glossary-fab:hover { transform: scale(1.1); box-shadow: var(--shadow-xl); }
        .glossary-panel {
            position: fixed; top: 0; right: -420px; width: 400px; max-width: 90vw;
            height: 100vh; background: var(--white); z-index: 10000;
            box-shadow: -8px 0 30px rgba(0,0,0,0.15); transition: right 0.35s ease;
            overflow-y: auto; padding: 32px 28px; font-family: 'Inter', sans-serif;
        }
        .glossary-panel.open { right: 0; }
        .glossary-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 9999;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease;
        }
        .glossary-overlay.open { opacity: 1; pointer-events: auto; }
        .glossary-panel-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 24px; padding-bottom: 16px; border-bottom: 2px solid var(--gray-200);
        }
        .glossary-panel-header h3 { font-size: 1.2rem; margin: 0; }
        .glossary-close {
            background: none; border: none; font-size: 1.5rem;
            cursor: pointer; color: var(--gray-500); padding: 4px; line-height: 1;
        }
        .glossary-close:hover { color: var(--navy); }
        .glossary-item { padding: 16px 0; border-bottom: 1px solid var(--gray-200); }
        .glossary-item:last-child { border-bottom: none; }
        .glossary-term { font-weight: 700; color: var(--navy); font-size: 0.95rem; margin-bottom: 2px; }
        .glossary-arrow { color: var(--orange); font-size: 0.82rem; font-weight: 600; margin-bottom: 4px; }
        .glossary-plain { font-size: 0.92rem; color: var(--gray-700); line-height: 1.65; }

        /* ========================================
           REVIEW FEEDBACK FAB
           ======================================== */
        .review-fab {
            position: fixed; bottom: 24px; left: 24px; z-index: 9998;
            padding: 10px 20px; border-radius: 24px;
            background: linear-gradient(135deg, var(--amber), var(--amber-dark));
            color: var(--white); border: none; font-family: 'Inter', sans-serif;
            font-weight: 600; font-size: 0.85rem; cursor: pointer;
            box-shadow: var(--shadow-lg); transition: all 0.3s var(--spring-bouncy);
            display: flex; align-items: center; gap: 8px;
        }
        .review-fab:hover { transform: scale(1.05); box-shadow: var(--shadow-xl); }
        .review-count {
            background: var(--white); color: var(--amber-dark);
            width: 22px; height: 22px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: 700;
        }

        /* ========================================
           MAPPING GRID
           ======================================== */
        .mapping-grid {
            display: grid; grid-template-columns: 1fr auto 1fr;
            gap: 12px; align-items: center;
        }
        @media (max-width: 768px) { .mapping-grid { grid-template-columns: 1fr; } }
        .mapping-left, .mapping-right {
            background: var(--white); border-radius: var(--radius);
            padding: 14px 18px; font-size: 0.9rem; border: 1px solid var(--gray-200);
        }
        .mapping-left { border-left: 3px solid var(--navy); }
        .mapping-right { border-left: 3px solid var(--orange); }
        .mapping-arrow { text-align: center; font-size: 1.5rem; color: var(--orange); }
        @media (max-width: 768px) { .mapping-arrow { transform: rotate(90deg); } }

        /* ========================================
           RUBRIC
           ======================================== */
        .rubric-q { display: flex; gap: 14px; margin-bottom: 16px; align-items: flex-start; }
        .rubric-num {
            width: 28px; height: 28px; background: var(--navy); color: var(--white);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: 700; flex-shrink: 0; font-family: 'Inter', sans-serif;
        }
        .rubric-q-text { font-weight: 600; color: var(--navy); margin-bottom: 4px; font-size: 0.95rem; }
        .rubric-mapper-link { font-size: 0.88rem; color: var(--gray-600); padding-left: 12px; border-left: 2px solid var(--orange); }

        /* ========================================
           DECISION TREE
           ======================================== */
        .decision-tree-container {
            background: var(--dt-bg); border-radius: var(--radius-lg);
            padding: 40px 24px; margin: 28px 0; overflow-x: auto;
            box-shadow: var(--shadow-xl); position: relative;
        }
        .decision-tree-container h3 { color: var(--white); text-align: center; margin-bottom: 24px; font-size: 1.3rem; }
        .dt-legend { display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; margin-bottom: 24px; }
        .dt-legend-item { display: flex; align-items: center; gap: 6px; color: var(--gray-400); font-size: 0.8rem; }
        .dt-legend-dot { width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0; }
        .dt-svg-wrap { display: flex; justify-content: center; overflow-x: auto; padding-bottom: 16px; }
        .dt-svg-wrap svg text { font-family: 'Inter', sans-serif; }
        .base-funding-note {
            background: rgba(236,201,75,0.12); border: 1px solid rgba(236,201,75,0.3);
            border-radius: var(--radius); padding: 16px 20px; margin-top: 20px;
            display: flex; justify-content: center; gap: 32px; flex-wrap: wrap;
        }
        .bf-item { text-align: center; color: var(--gray-300); font-size: 0.85rem; }
        .bf-amount { display: block; font-size: 1.25rem; font-weight: 700; color: var(--dt-yellow); }

        /* ========================================
           SWARM SVG
           ======================================== */
        .swarm-container { position: relative; margin: 24px 0; }
        .swarm-svg { width: 100%; max-width: 900px; margin: 0 auto; display: block; }
        .swarm-edge { stroke: var(--dt-line); stroke-width: 1.5; opacity: 0.4; }
        .swarm-edge.primary { stroke-width: 2.5; opacity: 0.6; }
        .node-circle { transition: all 0.3s ease; cursor: pointer; }
        .node-circle:hover { filter: brightness(1.2); transform-origin: center; }
        .node-label { fill: var(--white); font-family: 'Inter', sans-serif; pointer-events: none; }
        .swarm-tooltip {
            display: none; position: absolute; background: var(--navy-dark);
            color: var(--white); padding: 16px 20px; border-radius: var(--radius);
            box-shadow: var(--shadow-xl); max-width: 280px; z-index: 100;
            font-size: 0.85rem;
        }
        .swarm-tooltip h4 { font-size: 1rem; color: var(--orange-light); margin-bottom: 8px; }
        .st-label { font-size: 0.7rem; color: var(--gray-400); text-transform: uppercase; letter-spacing: 0.5px; margin-top: 8px; }
        .st-value { color: var(--gray-300); margin-top: 2px; }
        .st-empire { margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 0.8rem; color: var(--orange-light); font-style: italic; }

        /* ========================================
           MATRIX 2x2
           ======================================== */
        .matrix-2x2 {
            display: grid; grid-template-columns: auto 1fr 1fr;
            gap: 1px; background: var(--gray-200); border-radius: var(--radius-lg);
            overflow: hidden; margin: 24px 0; box-shadow: var(--shadow);
        }
        .matrix-corner { background: var(--cream); padding: 16px; }
        .matrix-header {
            background: var(--navy); color: var(--white); padding: 14px 20px;
            font-weight: 600; font-size: 0.9rem; text-align: center;
        }
        .matrix-row-label {
            background: var(--navy-dark); color: var(--white); padding: 16px;
            font-weight: 600; font-size: 0.85rem; display: flex; align-items: center;
            writing-mode: horizontal-tb;
        }
        .matrix-cell { background: var(--white); padding: 20px; }
        .matrix-cell h4 { font-family: 'Inter', sans-serif; font-size: 0.95rem; margin-bottom: 8px; color: var(--navy); }
        .matrix-cell ul { font-size: 0.85rem; padding-left: 16px; color: var(--gray-700); margin-bottom: 8px; }
        .matrix-cell li { margin-bottom: 4px; }
        .cell-ux { font-size: 0.82rem; color: var(--gray-600); padding: 8px; background: var(--cream); border-radius: 6px; margin-top: 8px; }
        .matrix-meta { display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.78rem; color: var(--gray-500); }
        .complexity { color: var(--orange); }

        /* ========================================
           DUAL MODEL
           ======================================== */
        .dual-model-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 24px 0; }
        @media (max-width: 768px) { .dual-model-grid { grid-template-columns: 1fr; } }
        .model-card {
            background: var(--white); border-radius: var(--radius-lg);
            overflow: hidden; box-shadow: var(--shadow);
        }
        .model-header { padding: 20px 24px; }
        .model-card.model-a .model-header { background: linear-gradient(135deg, var(--navy), var(--navy-light)); color: var(--white); }
        .model-card.model-b .model-header { background: linear-gradient(135deg, var(--orange-dark), var(--orange)); color: var(--white); }
        .model-header h3 { color: var(--white); font-size: 1.1rem; margin-bottom: 4px; }
        .model-header p { font-size: 0.85rem; opacity: 0.8; }
        .model-body { padding: 20px 24px; }
        .axis-map {
            position: relative; width: 200px; height: 200px; margin: 0 auto 16px;
            border: 1px solid var(--gray-300); border-radius: 4px;
            display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr;
        }
        .quadrant { display: flex; align-items: center; justify-content: center; text-align: center; font-size: 0.7rem; color: var(--gray-600); padding: 8px; }
        .quadrant.top-left { border-right: 1px solid var(--gray-300); border-bottom: 1px solid var(--gray-300); }
        .quadrant.top-right { border-bottom: 1px solid var(--gray-300); }
        .quadrant.bottom-left { border-right: 1px solid var(--gray-300); }
        .axis-label {
            position: absolute; font-size: 0.65rem; font-weight: 600;
            color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.5px;
        }
        .axis-label.top { top: -18px; left: 50%; transform: translateX(-50%); }
        .axis-label.bottom { bottom: -18px; left: 50%; transform: translateX(-50%); }
        .axis-label.left { left: -50px; top: 50%; transform: translateY(-50%); }
        .axis-label.right { right: -40px; top: 50%; transform: translateY(-50%); }
        .matrix-table { width: 100%; border-collapse: collapse; font-size: 0.82rem; }
        .matrix-table th { background: var(--cream); padding: 8px; text-align: left; font-weight: 600; color: var(--navy); border-bottom: 2px solid var(--gray-200); }
        .matrix-table td { padding: 8px; border-bottom: 1px solid var(--gray-200); }
        .influence-score { display: flex; gap: 3px; }
        .influence-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--orange); }
        .influence-dot.empty { background: var(--gray-200); }

        /* ========================================
           RESPONSIVE
           ======================================== */
        @media (max-width: 768px) {
            .hero { padding: 60px 0 40px; }
            .hero h1 { font-size: 1.8rem; }
            .hero-meta { flex-direction: column; gap: 8px; }
            section { padding: 40px 0; }
            .time-map-svg { min-height: 200px; }
            .time-map { padding: 32px 12px 40px; }
            .entry-cards { grid-template-columns: 1fr; }
            .tesseract-nav { bottom: 16px; }
            .tesseract-compact { width: 56px; height: 56px; }
            .tesseract-svg { width: 34px; height: 34px; }
            .review-fab { bottom: 80px; font-size: 0.75rem; padding: 8px 14px; }
            .glossary-fab { bottom: 80px; width: 44px; height: 44px; font-size: 1.2rem; }
            .tesseract-expanded { padding: 24px 16px; margin: 20px auto; }
            .dep-map svg { height: auto; }
            .dep-delivery { flex-direction: column; gap: 12px; }
        }

        /* ========================================
           TESSERACT NAVIGATOR — Compact
           "Progress bar meets tesseract meets TARDIS"
           ======================================== */
        .tesseract-nav {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9997;
            cursor: pointer;
        }
        .tesseract-compact {
            width: 72px; height: 72px;
            background: rgba(15, 35, 65, 0.94);
            border-radius: 50%;
            backdrop-filter: blur(16px);
            border: 1px solid rgba(237, 137, 54, 0.15);
            display: flex; align-items: center; justify-content: center;
            position: relative;
            transition: all 0.4s var(--spring-bouncy);
            /* Phase C: 3D perspective context */
            perspective: 600px;
            /* Enlivenment glow — JS sets --enliven-glow (0–1) */
            --enliven-glow: 0;
            box-shadow:
                0 8px 32px rgba(0,0,0,0.4),
                0 0 calc(20px + var(--enliven-glow) * 32px)
                    rgba(237,137,54, calc(0.06 + var(--enliven-glow) * 0.22));
        }
        .tesseract-compact:hover {
            transform: scale(1.15);
            border-color: rgba(237,137,54,0.35);
            box-shadow: 0 12px 40px rgba(0,0,0,0.5), 0 0 36px rgba(237,137,54,0.12);
        }
        /* ── PHASE C: 3D-simulating spin (replaces flat tesseractSpin) ── */
        .tesseract-svg {
            width: 44px; height: 44px;
            transform-style: preserve-3d;
            animation: tesseract3dSpin 24s linear infinite;
            filter: drop-shadow(0 0 3px rgba(237,137,54,0.15));
        }
        @keyframes tesseract3dSpin {
            0%   { transform: rotateX(0deg)   rotateY(0deg)   rotateZ(0deg);  }
            12%  { transform: rotateX(18deg)  rotateY(45deg)  rotateZ(2deg);  }
            25%  { transform: rotateX(15deg)  rotateY(90deg)  rotateZ(4deg);  }
            37%  { transform: rotateX(5deg)   rotateY(135deg) rotateZ(2deg);  }
            50%  { transform: rotateX(-10deg) rotateY(180deg) rotateZ(-2deg); }
            62%  { transform: rotateX(-14deg) rotateY(225deg) rotateZ(-5deg); }
            75%  { transform: rotateX(10deg)  rotateY(270deg) rotateZ(-2deg); }
            87%  { transform: rotateX(16deg)  rotateY(315deg) rotateZ(1deg);  }
            100% { transform: rotateX(0deg)   rotateY(360deg) rotateZ(0deg);  }
        }
        .tesseract-compact:hover .tesseract-svg { animation-duration: 48s; }
        .tesseract-edge { stroke: rgba(255,255,255,0.22); stroke-width: 1.2; fill: none; }
        .tesseract-edge.inner { stroke: rgba(237,137,54,0.30); stroke-width: 1; }
        .tesseract-edge.cross { stroke: rgba(255,255,255,0.10); stroke-dasharray: 2 3; stroke-width: 0.8; }
        .tesseract-vertex { transition: all 0.3s ease; }
        .tesseract-vertex.current {
            fill: var(--orange); r: 3.5;
            filter: drop-shadow(0 0 4px rgba(237,137,54,0.7));
        }
        .tesseract-vertex.enlivened {
            fill: var(--amber); r: 3;
            filter: drop-shadow(0 0 3px rgba(245,158,11,0.5));
        }
        @keyframes vertexPulse {
            0% { r: 3; } 50% { r: 5; } 100% { r: 3; }
        }
        .tesseract-vertex.pulsing { animation: vertexPulse 0.8s ease 3; fill: var(--amber); }

        /* Progress ring */
        .tesseract-progress {
            position: absolute; inset: -4px; border-radius: 50%; pointer-events: none;
        }
        .tesseract-progress circle { fill: none; stroke-width: 2; stroke-linecap: round; }
        .tesseract-progress .progress-bg { stroke: rgba(255,255,255,0.05); }
        .tesseract-progress .progress-fill {
            stroke: var(--amber);
            transform: rotate(-90deg); transform-origin: center;
            transition: stroke-dashoffset 0.8s var(--spring-gentle);
            filter: drop-shadow(0 0 4px rgba(245,158,11,0.3));
        }

        /* Hover tooltip */
        .tesseract-tooltip {
            position: absolute; bottom: calc(100% + 14px); left: 50%;
            transform: translateX(-50%) translateY(8px);
            background: rgba(15,35,65,0.96); color: var(--white);
            padding: 10px 16px; border-radius: 10px;
            font-family: 'Inter', sans-serif; font-size: 0.78rem;
            white-space: nowrap; opacity: 0; pointer-events: none;
            transition: all 0.25s ease;
            box-shadow: 0 8px 24px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .tesseract-tooltip::after {
            content: ''; position: absolute; top: 100%; left: 50%;
            transform: translateX(-50%); border: 6px solid transparent;
            border-top-color: rgba(15,35,65,0.96);
        }
        .tesseract-compact:hover .tesseract-tooltip {
            opacity: 1; transform: translateX(-50%) translateY(0);
        }
        .tt-section { color: var(--orange-light); font-weight: 600; display: block; margin-bottom: 2px; }
        .tt-progress { color: var(--gray-400); }

        /* ========================================
           TESSERACT EXPANDED — The TARDIS View
           "Bigger on the inside"
           ======================================== */
        .tesseract-overlay {
            position: fixed; inset: 0;
            background: rgba(10, 25, 50, 0.97);
            z-index: 10001; opacity: 0; pointer-events: none;
            transition: opacity 0.4s ease;
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }
        .tesseract-overlay.open { opacity: 1; pointer-events: auto; }
        .tesseract-expanded {
            max-width: 880px; margin: 48px auto; padding: 40px 24px;
            opacity: 0; transform: scale(0.92);
            transition: all 0.6s var(--spring-bouncy);
        }
        .tesseract-overlay.open .tesseract-expanded {
            opacity: 1; transform: scale(1);
        }
        .tesseract-close {
            position: fixed; top: 20px; right: 20px;
            width: 44px; height: 44px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 50%; color: var(--white);
            font-size: 1.3rem; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.3s ease; z-index: 10002;
        }
        .tesseract-close:hover { background: rgba(255,255,255,0.12); transform: scale(1.1); }
        .expanded-header { text-align: center; margin-bottom: 36px; }
        .expanded-header h2 { color: var(--white); font-size: 1.8rem; margin-bottom: 8px; }
        .expanded-header p { color: var(--gray-400); font-size: 0.95rem; }
        .expanded-score {
            display: inline-flex; align-items: center; gap: 10px;
            background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.2);
            border-radius: 24px; padding: 8px 20px; margin-top: 16px;
            font-family: 'Inter', sans-serif;
        }
        .score-num { font-size: 1.4rem; font-weight: 700; color: var(--amber); }
        .score-label { font-size: 0.82rem; color: var(--gray-400); }

        /* ── PHASE C: Organic dep-map ───────────────────────────────── */
        .dep-map { margin: 24px auto; }
        .dep-map svg { width: 100%; display: block; }

        /* Ellipse nodes */
        .dep-node         { cursor: pointer; transition: filter 0.3s ease; }
        .dep-node:hover   { filter: brightness(1.22) drop-shadow(0 0 6px rgba(255,255,255,0.15)); }
        .dep-node-bg      { transition: filter 0.4s ease; }
        .dep-node.enlivened .dep-node-bg {
            filter: drop-shadow(0 0 12px rgba(245,158,11,0.55))
                    drop-shadow(0 0 4px rgba(245,158,11,0.4));
        }
        .dep-node-label {
            fill: var(--white); font-family: 'Inter', sans-serif;
            font-size: 10.5px; font-weight: 500; pointer-events: none;
        }
        .dep-node-num {
            fill: rgba(255,255,255,0.65); font-family: 'Inter', sans-serif;
            font-size: 8.5px; font-weight: 700; letter-spacing: 0.08em;
            pointer-events: none;
        }

        /* Curved path edges */
        .dep-edge {
            fill: none;
            stroke: rgba(255,255,255,0.12);
            stroke-width: 1.6;
        }
        /* Path draw-in animation — controlled by JS via attributes */
        .dep-edge-path {
            fill: none;
            stroke-width: 2;
        }

        /* Enlivened edges */
        .dep-edge.enlivened {
            stroke: var(--amber); stroke-width: 2.2;
            filter: drop-shadow(0 0 4px rgba(245,158,11,0.35));
            opacity: 0.8;
        }
        /* Cascade flash */
        @keyframes cascadeFlow {
            0%   { stroke-dashoffset: 80; opacity: 0; }
            15%  { opacity: 0.9; }
            100% { stroke-dashoffset: 0; opacity: 0; }
        }
        .dep-edge.cascading {
            stroke: var(--amber); stroke-width: 2.8;
            stroke-dasharray: 12 5;
            animation: cascadeFlow 1.2s var(--ease-out-expo) forwards;
        }

        /* Flowing particles along key paths */
        .dep-flow-particle {
            fill: var(--amber);
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        .tesseract-overlay.open .dep-flow-particle { opacity: 0.65; }
        .dep-delivery {
            display: flex; justify-content: center; gap: 48px;
            margin-top: 32px; padding-top: 24px;
            border-top: 1px solid rgba(255,255,255,0.06);
        }
        .dep-milestone { text-align: center; font-family: 'Inter', sans-serif; }
        .dep-milestone-dot {
            width: 44px; height: 44px; border-radius: 50%; margin: 0 auto 8px;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }
        .dep-milestone-dot.now {
            background: linear-gradient(135deg, var(--orange), var(--orange-dark));
            box-shadow: 0 4px 16px rgba(237,137,54,0.3);
        }
        .dep-milestone-dot.future {
            background: rgba(45,74,124,0.6);
            border: 2px solid var(--orange);
        }
        .dep-milestone-label { color: var(--white); font-weight: 600; font-size: 0.85rem; }
        .dep-milestone-date { color: var(--gray-500); font-size: 0.75rem; margin-top: 2px; }

        /* Cascade indicator in feedback zones */
        .cascade-indicator {
            display: flex; align-items: center; gap: 8px;
            margin-bottom: 12px; padding: 8px 14px;
            background: rgba(245,158,11,0.06); border-radius: 8px;
            font-size: 0.78rem; color: var(--amber-dark);
            font-family: 'Inter', sans-serif;
        }
        .cascade-targets { font-weight: 600; color: var(--amber); }

        /* ========================================
           PHASE F — REDUCED MOTION
           ======================================== */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                transition-delay: 0ms !important;
                scroll-behavior: auto !important;
            }
            .reveal, .card-grid .card.reveal, .journey-step.reveal,
            .quote-block.reveal, .section-header.reveal,
            .swarm-container.reveal, .split-card.reveal {
                opacity: 1 !important; transform: none !important;
            }
            .reveal *, .quote-block.reveal p, .quote-block.reveal .quote-attribution,
            .quote-block.reveal::before, .journey-step.reveal .step-number,
            .journey-step.reveal .step-content, .section-header.reveal .section-number,
            .section-header.reveal h2, .section-header.reveal p {
                opacity: 1 !important; transform: none !important;
                animation: none !important; transition: none !important;
            }
            .hero { animation: none !important; background-size: 100% 100% !important; }
            .hero-particle { display: none !important; }
            .hero-title .char { opacity: 1 !important; transform: none !important; animation: none !important; filter: none !important; }
            .typewriter-cursor { display: none !important; }
            .swarm-container.reveal .swarm-svg { opacity: 1 !important; }
            .swarm-container.reveal.visible .swarm-svg > g:first-child line,
            .swarm-container.reveal.visible .swarm-svg line.swarm-edge.primary {
                animation: none !important; stroke-dasharray: none !important;
            }
            .tesseract-svg { animation: none !important; }
            .time-particle, .hero-accent { animation: none !important; }
        }
        /* ========================================
           CHECKLIST (Context Materials)
           ======================================== */
        .checklist { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
        .checklist-group h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; font-size: 1rem; }
        .checklist-items { list-style: none; }
        .checklist-items li { display: flex; align-items: flex-start; gap: 10px; padding: 10px 0; border-bottom: 1px solid var(--gray-200); }
        .checklist-items li:last-child { border-bottom: none; }
        .check-icon { width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; flex-shrink: 0; }
        .check-icon.done { background: var(--success); color: var(--white); }
        .check-icon.pending { background: var(--warning); color: var(--navy); }
    </style>
</head>
<body>
<!-- Check auth -->
<script>
if (sessionStorage.getItem('eaf-auth') !== 'true') {
    window.location.href = 'index.html';
}
</script>

<!-- ================================================================
     HERO SECTION
     ================================================================ -->
<header class="hero">
    <div class="hero-particles-layer">
        <div class="hero-particle"></div><div class="hero-particle"></div>
        <div class="hero-particle"></div><div class="hero-particle"></div>
        <div class="hero-particle"></div><div class="hero-particle"></div>
        <div class="hero-particle lg"></div><div class="hero-particle lg"></div>
        <div class="hero-particle sm"></div><div class="hero-particle sm"></div>
        <div class="hero-particle sm"></div><div class="hero-particle sm"></div>
        <div class="hero-particle glow"></div><div class="hero-particle glow"></div>
        <div class="hero-particle glow"></div>
    </div>
    <div class="container">
        <div class="hero-empire">empire</div>
        <h1 class="hero-title" id="heroTitle" aria-label="Adaptive Power Mapping System">Adaptive Power Mapping System</h1>
        <p class="hero-subtitle" id="heroSubtitle"></p>
        <noscript><p class="hero-subtitle">Living Product Specification — Energy Action Fund × empire | Co-Design Document</p></noscript>
        <div class="hero-meta">
            <span>Discovery Call: Jan 30, 2026</span>
            <span>Phase 1 Deadline: March 31, 2026</span>
        </div>
        <div class="hero-intro-box">
            <strong>This is a living document — your feedback shapes what we build.</strong><br><br>
            <strong>Brain emojis (🧠)</strong> appear throughout. Hover or tap to see <em>cognitive lineage</em>: who contributed each insight, where it came from, and when. This is how we honor the thinking behind the design.<br><br>
            <strong>"Your Turn" boxes</strong> invite your input at every section. Type your feedback directly — your responses are saved automatically.
        </div>
    </div>
</header>
<div class="hero-accent"></div>

<!-- ================================================================
     TIME MAP — Temporal Orientation
     ================================================================ -->
<div class="container">
    <div class="time-map reveal">
        <h3>Where We Are</h3>
        <p class="time-map-subtitle">A living timeline — your feedback today cascades through everything that follows</p>
        <svg class="time-map-svg" viewBox="0 0 900 220" id="timeMapSvg">
            <defs>
                <linearGradient id="timeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="rgba(160,174,192,0.4)"/>
                    <stop offset="30%" stop-color="rgba(245,158,11,0.8)"/>
                    <stop offset="60%" stop-color="rgba(124,58,237,0.6)"/>
                    <stop offset="100%" stop-color="rgba(59,130,246,0.5)"/>
                </linearGradient>
                <linearGradient id="timeGradGlow" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="rgba(160,174,192,0.2)"/>
                    <stop offset="35%" stop-color="rgba(245,158,11,0.5)"/>
                    <stop offset="65%" stop-color="rgba(124,58,237,0.3)"/>
                    <stop offset="100%" stop-color="rgba(59,130,246,0.2)"/>
                </linearGradient>
                <radialGradient id="pastGrad"><stop offset="0%" stop-color="#718096"/><stop offset="100%" stop-color="#4a5568"/></radialGradient>
                <radialGradient id="presentGrad"><stop offset="0%" stop-color="#f6ad55"/><stop offset="100%" stop-color="#dd6b20"/></radialGradient>
                <radialGradient id="futureGrad1"><stop offset="0%" stop-color="#7c3aed"/><stop offset="100%" stop-color="#6b21a8"/></radialGradient>
                <radialGradient id="futureGrad2"><stop offset="0%" stop-color="#3b82f6"/><stop offset="100%" stop-color="#2563eb"/></radialGradient>
                <filter id="nodeGlow"><feGaussianBlur stdDeviation="4" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
            </defs>
            <!-- Flowing curved path background -->
            <path class="time-path-bg" d="M 100,110 C 200,80 250,140 350,110 C 450,80 500,140 600,110 C 700,80 750,140 800,110"/>
            <!-- Animated glow behind path -->
            <path class="time-path-glow" d="M 100,110 C 200,80 250,140 350,110 C 450,80 500,140 600,110 C 700,80 750,140 800,110" stroke="url(#timeGradGlow)"/>
            <!-- Animated flowing dashes -->
            <path class="time-path-flow" d="M 100,110 C 200,80 250,140 350,110 C 450,80 500,140 600,110 C 700,80 750,140 800,110" stroke="url(#timeGrad)" id="timeFlowPath"/>
            <!-- Floating particles along path -->
            <circle class="time-particle" fill="#f59e0b"><animateMotion dur="6s" repeatCount="indefinite"><mpath href="#timeFlowPath"/></animateMotion></circle>
            <circle class="time-particle" fill="#7c3aed" r="2"><animateMotion dur="6s" repeatCount="indefinite" begin="1.5s"><mpath href="#timeFlowPath"/></animateMotion></circle>
            <circle class="time-particle" fill="#14b8a6" r="1.8"><animateMotion dur="6s" repeatCount="indefinite" begin="3s"><mpath href="#timeFlowPath"/></animateMotion></circle>
            <circle class="time-particle" fill="#3b82f6" r="2.2"><animateMotion dur="6s" repeatCount="indefinite" begin="4.5s"><mpath href="#timeFlowPath"/></animateMotion></circle>

            <!-- Node 1: Discovery (Past) -->
            <g class="time-node-group past" transform="translate(100,110)">
                <circle class="time-node-ring" r="32" stroke="#718096"/>
                <circle r="26" fill="url(#pastGrad)" opacity="0.9"/>
                <text class="time-node-emoji" text-anchor="middle" y="7">📞</text>
                <text class="time-node-label" text-anchor="middle" y="48">Discovery</text>
                <text class="time-node-date" text-anchor="middle" y="62">Jan 30, 2026</text>
                <text class="time-node-desc" text-anchor="middle" y="74">Your vision captured</text>
            </g>

            <!-- Node 2: Your Input Today (Present — ACTIVE) -->
            <g class="time-node-group present" transform="translate(350,110)" filter="url(#nodeGlow)">
                <circle class="time-node-ripple" r="26" stroke="#f59e0b"/>
                <circle class="time-node-ripple" r="26" stroke="#f59e0b"/>
                <circle class="time-node-ripple" r="26" stroke="#f59e0b"/>
                <circle class="time-node-ring" r="36" stroke="#f59e0b" opacity="0.2"/>
                <circle r="28" fill="url(#presentGrad)"/>
                <text class="time-node-emoji" text-anchor="middle" y="7">📄</text>
                <text class="time-node-label" text-anchor="middle" y="52" fill="#f6ad55" font-size="14">Your Input Today</text>
                <text class="time-node-date" text-anchor="middle" y="66">Feb 25, 2026</text>
                <text class="time-node-desc" text-anchor="middle" y="78">Feedback shapes the build</text>
            </g>

            <!-- Node 3: Updated Prototype (Future) -->
            <g class="time-node-group future" transform="translate(600,110)">
                <circle class="time-node-ring" r="32" stroke="#7c3aed"/>
                <circle r="26" fill="url(#futureGrad1)" opacity="0.85"/>
                <circle r="26" fill="none" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="4 4"/>
                <text class="time-node-emoji" text-anchor="middle" y="7">🔧</text>
                <text class="time-node-label" text-anchor="middle" y="48">Updated Prototype</text>
                <text class="time-node-date" text-anchor="middle" y="62">Friday, Feb 27</text>
                <text class="time-node-desc" text-anchor="middle" y="74">Your feedback incorporated</text>
            </g>

            <!-- Node 4: Board-Ready (Future) -->
            <g class="time-node-group future" transform="translate(800,110)">
                <circle class="time-node-ring" r="32" stroke="#3b82f6"/>
                <circle r="26" fill="url(#futureGrad2)" opacity="0.85"/>
                <circle r="26" fill="none" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="4 4"/>
                <text class="time-node-emoji" text-anchor="middle" y="7">🎯</text>
                <text class="time-node-label" text-anchor="middle" y="48">Board-Ready</text>
                <text class="time-node-date" text-anchor="middle" y="62">Tuesday, Mar 3</text>
                <text class="time-node-desc" text-anchor="middle" y="74">Full prototype for your board</text>
            </g>
        </svg>
    </div>
</div>

<!-- ================================================================
     SECTION 00 — Portal to the Alliance
     ================================================================ -->
<section class="portal-section" id="section-00">
    <div class="container">
        <div class="portal-welcome reveal">
            <div class="section-number">SECTION 00</div>
            <h2>Welcome to the Alliance</h2>
            <p class="welcome-text">
                This is an experiential and evolving agreement — not a static list of features to approve or reject.
                It's <em>an invitation to build something together</em> — a co-design document where your
                expertise in advocacy and power mapping meets our expertise in principles-based computing, living strategies, and full-stack infrastructure.
            </p>
            <p class="welcome-text" style="margin-top: 16px;">
                Throughout this document, you'll find <em>Your Turn</em> boxes. These aren't formalities.
                Your responses literally change what gets built. Where we got something wrong, that's not a failure —
                it's exactly the kind of signal that makes the final instrument better.
            </p>
        </div>

        <h3 class="reveal" style="text-align: center; font-size: 1.3rem; margin-bottom: 24px;">How to Navigate This Document</h3>
        <div class="entry-cards reveal">
            <div class="entry-card" onclick="document.getElementById('executive-vision').scrollIntoView({behavior:'smooth'})">
                <div class="entry-time">5 min</div>
                <h4>The Quick Pulse</h4>
                <p>Read the <strong>Executive Vision</strong> and respond to one <strong>Your Turn</strong> box. That alone gives us something real to work with.</p>
            </div>
            <div class="entry-card" onclick="document.getElementById('user-journey').scrollIntoView({behavior:'smooth'})">
                <div class="entry-time">30 min</div>
                <h4>The Working Session</h4>
                <p>Sections 1–5 cover what the instrument does and how it maps to your existing workflow — the decision tree, the workbook rubric, your state-level analysis.</p>
            </div>
            <div class="entry-card" onclick="document.getElementById('architecture').scrollIntoView({behavior:'smooth'})">
                <div class="entry-time">Full</div>
                <h4>The Deep Dive</h4>
                <p>Explore everything. The technical architecture, the AI processing pipeline, the economics. It's designed to be explored, not consumed linearly.</p>
            </div>
        </div>

        <div class="different-block reveal">
            <h3>What Makes This Different</h3>
            <p>
                Most technology specs carry hidden assumptions: <strong>the vendor knows best</strong>, your job is to approve or reject,
                and features are what matter. Those assumptions create a power dynamic where the client evaluates from a position of less knowledge.
            </p>
            <p>
                We're doing the opposite. This spec is built on the belief that <strong>expertise compounds when it flows in every direction</strong>.
                You know the landscape of power — who holds it, how it moves, what changes it. We bring living strategies, principles-based computing,
                and alliance economics — approaches where building together makes everyone more capable. This isn't two sides contributing halves; it's a system where every contribution amplifies every other.
            </p>
            <div class="unnamed-grid">
                <div class="unnamed-item"><span class="swap-arrow">→</span><div><span class="label-traditional">"The vendor knows best"</span><span class="label-ours">Your expertise drives the design</span></div></div>
                <div class="unnamed-item"><span class="swap-arrow">→</span><div><span class="label-traditional">"Approve or reject"</span><span class="label-ours">Reshape and redirect</span></div></div>
                <div class="unnamed-item"><span class="swap-arrow">→</span><div><span class="label-traditional">"Features are what matter"</span><span class="label-ours">Experience is what matters</span></div></div>
                <div class="unnamed-item"><span class="swap-arrow">→</span><div><span class="label-traditional">"The spec is final"</span><span class="label-ours">The spec is a conversation</span></div></div>
            </div>
        </div>

        <div class="ask-block reveal">
            <h3>What We Need From You</h3>
            <p>
                Explore at whatever depth feels right. Respond in the Your Turn boxes where something strikes you.
                And above all — <strong>be honest</strong>. If something feels wrong, confusing, or over-engineered,
                that's exactly what we need to hear. The best feedback isn't polite; it's real.
            </p>
            <ul class="ask-list">
                <li><span>🔍</span> Explore at your own pace</li>
                <li><span>💬</span> Respond in Your Turn boxes</li>
                <li><span>🎯</span> Flag what doesn't match your reality</li>
                <li><span>💡</span> Tell us what we're missing</li>
            </ul>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 01 — Executive Vision
     ================================================================ -->
<section id="executive-vision">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">01</span>
            <h2>Executive Vision</h2>
            <p>The core insight that drives everything we're building</p>
        </div>

        <div class="quote-block reveal">
            <p>"What if you could take your campaign plan, feed it to an AI, and it pre-populates your power map? You'd still need to correct it — 'we don't have a Sierra Club chapter here' — but you're starting from something instead of nothing."</p>
            <div class="quote-attribution">
                — Ryan Werder, EAF
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Ryan articulated this vision during the discovery call, describing the gap between having great campaign plans and the manual, time-consuming process of translating them into actionable power maps.
                        <span class="tooltip-source">Source: Discovery call transcript, 00:32:05-00:34:17</span>
                    </span>
                </span>
            </div>
        </div>

        <div class="callout reveal" style="margin-bottom: 28px;">
            <p><strong>The design principle:</strong> "How do you activate the human strategic intuition?" — Brett Horvath. Ryan's concern — that current power mapping "often reinforces existing preconceptions" — frames the challenge. This instrument doesn't replace human judgment. It makes the landscape visible so that judgment can operate on a richer substrate.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Brett articulated this as the centering design question during the discovery call, responding to Ryan's description of the gap between information and strategic insight.
                        <span class="tooltip-source">Source: Discovery call transcript, Jan 30 2026</span>
                    </span>
                </span>
            </p>
        </div>

        <div class="split-grid reveal">
            <div class="split-card problem">
                <div class="split-card-header problem">The Problem</div>
                <ul>
                    <li><strong>Bias confirmation:</strong> Current process reinforces what teams already believe rather than revealing what they can't yet see</li>
                    <li><strong>Uneven sophistication:</strong> "We're asking folks who just don't have any experience doing this to put together a campaign plan that wows our national team of experts — and that's not terribly fair"
                        <span class="cognitive-lineage" tabindex="0">🧠
                            <span class="tooltip">
                                <span class="tooltip-header">Cognitive Lineage</span>
                                Ryan describing the gap between what EAF expects of grantees and the support infrastructure available to them.
                                <span class="tooltip-source">Source: Discovery call transcript, Jan 30 2026</span>
                            </span>
                        </span>
                    </li>
                    <li><strong>Slow sense-making cycles:</strong> The translation from information to strategic insight takes weeks of convenings, conversations, and draft revisions</li>
                    <li><strong>Known unknowns go unaddressed:</strong> "I think we should talk about the land conservancies but I don't know where they sit"</li>
                    <li><strong>No safe space for assumption-testing:</strong> Questioning a campaign's assumptions feels like questioning the team's competence</li>
                </ul>
            </div>
            <div class="split-card opportunity">
                <div class="split-card-header opportunity">The Opportunity</div>
                <ul>
                    <li><strong>Strategic surprise:</strong> Surface actors, connections, and patterns that campaign teams couldn't have seen on their own</li>
                    <li><strong>Democratize sophistication:</strong> Give every grantee access to the strategic frameworks that currently live only in the heads of Ryan, Tom, and the senior evaluation team</li>
                    <li><strong>Accelerate sense-making:</strong> Compress weeks of iterative analysis into hours of interactive exploration</li>
                    <li><strong>"Magic" for board presentations:</strong> Ryan said it — "what you are going to be putting together is already going to feel like magic"</li>
                    <li><strong>Power maps as living infrastructure:</strong> Not static snapshots but dynamic models that learn from every correction and scenario test</li>
                </ul>
            </div>
        </div>

        <div class="feedback-zone reveal" data-section="executive-vision">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">Does this capture the core problem? What would you add about what's broken today and what "magic" would look like?</p>
            <textarea class="feedback-textarea" placeholder="Think about your most recent experience with power mapping... What frustrated you? What surprised you? What do you wish the instrument could do?" aria-label="Feedback for Executive Vision section"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('executive-vision')">Submit Feedback</button>
                <span class="feedback-status" id="status-executive-vision"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 02 — Essential Experiences
     ================================================================ -->
<section id="essential-experiences">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">02</span>
            <h2>Essential Experiences</h2>
            <p>What this instrument must FEEL like — the experiential milestones that define success</p>
        </div>

        <div class="callout reveal">
            <p><strong>Design Principle:</strong> "How do you activate the human strategic intuition?"
            <span class="cognitive-lineage" tabindex="0">🧠
                <span class="tooltip">
                    <span class="tooltip-header">Cognitive Lineage</span>
                    Brett Horvath articulated this as the core design challenge — the tool succeeds not when it replaces thinking, but when it activates thinking that was always possible but couldn't find its object.
                    <span class="tooltip-source">Source: Discovery Call, Jan 30 2026 — Brett's framing of the design challenge</span>
                </span>
            </span>
            Every feature, every interaction, every visual choice must answer this question. The following three perspectives define what success FEELS like.</p>
        </div>

        <h3 class="reveal" style="margin-top: 32px;">Ryan's POV: Strategic Surprise</h3>
        <p class="subsection-desc reveal">The moment a campaign team sees what they couldn't see alone — and that seeing changes what they do next.</p>

        <div class="quote-block reveal">
            <p>"My concern is that it often reinforces existing preconceptions."</p>
            <div class="quote-attribution">— Ryan Werder, EAF
                <span class="cognitive-lineage" tabindex="0">🧠<span class="tooltip"><span class="tooltip-header">Cognitive Lineage</span>Ryan named the fundamental bottleneck: current power mapping produces outputs that confirm what teams already believe rather than revealing what they can't yet see.<span class="tooltip-source">Source: Discovery Call, Jan 30 2026 ~14:22</span></span></span>
            </div>
        </div>

        <div class="card-grid reveal">
            <div class="card">
                <div class="card-header"><div class="card-icon">🔍</div><div><h3>The Missing Actor Surprise</h3><span class="card-tag">Recognition → Revelation</span></div></div>
                <p>Not just "who else is out there" but <strong>"who would change everything if they showed up."</strong> The veterans group providing bipartisan cover. The faith community reaching constituents no environmental group can.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        This is the unknown unknown: a blind spot in the team's composition creates a blind spot in the strategy. The tool must surface actors that the team structurally cannot see because of who they are.
                        <span class="tooltip-source">Source: Discovery Call, Jan 30 2026 — Ryan describing blind spots in campaign team composition</span>
                    </span>
                </span>
                </p>
            </div>
            <div class="card">
                <div class="card-header"><div class="card-icon">🛡️</div><div><h3>Assumption-Testing Relief</h3><span class="card-tag">Interaction</span></div></div>
                <p>Currently, questioning a campaign's assumptions feels like questioning the team's competence. The instrument creates a safe space to ask <strong>"what if we're wrong about the Chamber?"</strong> without anyone losing face.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        The assumption that's never been tested because the consequences of testing it feel too high. The tool makes scenario exploration psychologically safe.
                        <span class="tooltip-source">Source: Discovery Call, Jan 30 2026 — Ryan on scenario testing and drag-and-drop dynamics</span>
                    </span>
                </span>
                </p>
            </div>
            <div class="card">
                <div class="card-header"><div class="card-icon">⚡</div><div><h3>Sense-Making Acceleration</h3><span class="card-tag">Transformation</span></div></div>
                <p>What currently takes weeks of convenings compresses into hours of interactive exploration. Not because the instrument replaces human judgment, but because <strong>it makes the landscape visible so that judgment can operate on a richer substrate.</strong></p>
            </div>
            <div class="card">
                <div class="card-header"><div class="card-icon">🌊</div><div><h3>Democratization of Sophistication</h3><span class="card-tag">Transcendence</span></div></div>
                <p>The instrument's guided prompts give every grantee access to strategic frameworks that currently live only in the heads of Ryan, Tom, and the senior evaluation team.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        The floor of strategic quality across all grantees rises when every team has access to the same frameworks — not as templates to fill out, but as interactive reasoning to think with.
                        <span class="tooltip-source">Source: Discovery Call, Jan 30 2026 — Ryan on the uneven distribution of strategic expertise</span>
                    </span>
                </span>
                </p>
            </div>
        </div>

        <h3 class="reveal" style="margin-top: 40px;">The EAF Team: Expanding Agency</h3>
        <p class="subsection-desc reveal">Not a single moment — a progressive expansion of what the team can see, do, and imagine.</p>

        <div class="quote-block reveal">
            <p>"What you are going to be putting together is already going to feel like magic."</p>
            <div class="quote-attribution">— Ryan Werder, EAF</div>
        </div>

        <div class="journey-steps reveal">
            <div class="journey-step"><div class="step-number">1</div><div class="step-content"><h4>Recognition — "Oh, it can read our plans."</h4><p>Take the Minnesota 49-slide PPTX. Watch the system parse it. Actors emerge. Relationships surface. The EAF team sees <strong>their own strategic thinking reflected back in structured form.</strong></p></div></div>
            <div class="journey-step"><div class="step-number">2</div><div class="step-content"><h4>Revelation — "Oh, it sees what we missed."</h4><p>The system ingests the Iowa plan and surfaces what's structurally absent. Where's the utility engagement strategy? Where are the unexpected allies?</p></div></div>
            <div class="journey-step"><div class="step-number">3</div><div class="step-content"><h4>Interaction — "Oh, we can ask it questions."</h4><p>"Which campaigns are most vulnerable to a utility counter-offensive?" "Where do we have the weakest coalition infrastructure?" This is where the two models converge.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        The governors powermap spreadsheet columns — "Who in COALITION has best relationship?" and "Who NATIONALLY has best relationship?" — capture relational thinking that the quadrant chart alone cannot represent. The dual-model approach is grounded in EAF's existing practice.
                        <span class="tooltip-source">Source: Governors Powermap Spreadsheet (MI, PA, MD templates); EAF State Planning Workbook</span>
                    </span>
                </span>
            </p></div></div>
            <div class="journey-step"><div class="step-number">4</div><div class="step-content"><h4>Transformation — "Oh, this changes how we work."</h4><p>Campaign plan generation means grantees start with a populated first draft. <strong>TomBot</strong> — an agent encoding Tom's scoring frameworks — makes his analytical rigor available to every campaign team.</p></div></div>
            <div class="journey-step"><div class="step-number">5</div><div class="step-content"><h4>Transcendence — "Oh, this is infrastructure for the movement."</h4><p>Every campaign plan ingested trains the system. Every power map validated builds collective knowledge. Every scenario tested contributes to understanding political dynamics no single organization could model alone.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Ryan articulated the bigger vision unprompted — the tool as movement infrastructure, not just an EAF product.
                        <span class="tooltip-source">Source: Discovery Call, Jan 30 2026 — Ryan on broader movement impact</span>
                    </span>
                </span>
            </p></div></div>
        </div>

        <div class="feedback-zone reveal" data-section="essential-experiences">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">What would "magic" look like for your team? Describe a moment where the instrument would change how you think about a campaign.</p>
            <textarea class="feedback-textarea" placeholder="Think about a specific campaign moment — a meeting, an evaluation, a planning session — where having this instrument would have changed the outcome." aria-label="Describe what magic looks like for your team"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('essential-experiences')">Submit Feedback</button>
                <span class="feedback-status" id="status-essential-experiences"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 03 — Primary User Journey
     ================================================================ -->
<section id="user-journey">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">03</span>
            <h2>Primary User Journey</h2>
            <p>From campaign plan to strategic insight — an experiential progression</p>
        </div>

        <div class="journey-steps reveal">
            <div class="journey-step"><div class="step-number">1</div><div class="step-content"><h3>Document Ingestion</h3><p>Upload your campaign plan in any format — PDF, PowerPoint, Google Docs. The system accepts the artifacts you already create.</p></div></div>
            <div class="journey-step"><div class="step-number">2</div><div class="step-content"><h3>Automated Power Map Generation</h3><p>AI analyzes your document and generates <strong>both</strong> a two-axis strategic visualization AND a relational influence matrix, identifying actors, stances, influence levels, and relationship networks.</p></div></div>
            <div class="journey-step"><div class="step-number">3</div><div class="step-content"><h3>Human Review &amp; Correction</h3><p>"We don't have a Sierra Club chapter here." Correct AI assumptions with local knowledge. Every correction improves future maps.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Ryan used this exact example to illustrate why human review is essential—AI can't know local organizational presence without being told.
                        <span class="tooltip-source">Source: Discovery call transcript, 00:33:42</span>
                    </span>
                </span>
            </p></div></div>
            <div class="journey-step"><div class="step-number">4</div><div class="step-content"><h3>Gap Identification</h3><p>The system surfaces missing stakeholders and relationship gaps: "You have no one with a direct line to the PUC chair. Here are three people who might."</p></div></div>
            <div class="journey-step"><div class="step-number">5</div><div class="step-content"><h3>Scenario Testing</h3><p>Ask "what if" questions and see cascade effects: "What happens if the utility association flips neutral? Who else moves?"</p></div></div>
            <div class="journey-step"><div class="step-number">6</div><div class="step-content"><h3>Export &amp; Share</h3><p>Generate board-ready visualizations, data exports (CSV), and narrative summaries that explain the strategic landscape.</p></div></div>
        </div>

        <div class="feedback-zone reveal" data-section="user-journey">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">Walk us through a typical power mapping session. What steps are we missing?</p>
            <textarea class="feedback-textarea" placeholder="Describe your current workflow... What comes before? What comes after? Where do things get stuck?" aria-label="Feedback for User Journey section"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('user-journey')">Submit Feedback</button>
                <span class="feedback-status" id="status-user-journey"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 04 — Campaign Decision Framework
     ================================================================ -->
<section id="section-04">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">04</span>
            <h2>Campaign Decision Framework</h2>
            <p>How the Power Mapper integrates with EAF's existing evaluation workflow
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Why This Section Exists</span>
                        The power mapper isn't a standalone tool — it's designed to plug directly into how EAF already evaluates and funds state campaigns. These frameworks surfaced from EAF's Miro board and Campaign Workbook.
                        <span class="tooltip-source">Source: EAF Miro Board + Campaign Workbook Rubric</span>
                    </span>
                </span>
            </p>
        </div>

        <div class="quote-block reveal">
            <p>EAF doesn't just ask "what does the political landscape look like?" — they ask "given this landscape, what level of investment is warranted, and what kind of campaign should we run?" The power mapper must speak directly to that decision logic.</p>
            <div class="quote-attribution">— Design principle from EAF materials analysis</div>
        </div>

        <p class="reveal" style="margin-bottom: 32px; font-size: 1.05rem; color: var(--gray-700);">
            EAF uses two complementary frameworks. The <strong>Legislative Campaign Decision Tree</strong> routes each state to an investment type based on political conditions. The <strong>Campaign Workbook Rubric</strong> evaluates plan quality across 11 questions. The power mapper feeds both.
            <span class="cognitive-lineage" tabindex="0">🧠
                <span class="tooltip">
                    <span class="tooltip-header">The Rubric as Operating System</span>
                    The rubric isn't just an evaluation form — it's the framework through which EAF decides what to fund and at what level. The power mapper must make these questions answerable through visualization rather than guesswork.
                    <span class="tooltip-source">Source: EAF Campaign Workbook Rubric spreadsheet</span>
                </span>
            </span>
        </p>

        <div class="reveal" style="margin-top: 32px;">
            <h3 style="margin-bottom: 20px;">How the Power Mapper Feeds the Decision Tree
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">From Analysis to Integration</span>
                        The decision tree treats Impact-Difficulty as a fixed input. But the power mapper reveals difficulty as dynamic — it shifts based on who you mobilize and which relationships you activate.
                        <span class="tooltip-source">Source: Deep analysis of EAF materials</span>
                    </span>
                </span>
            </h3>
            <div style="display: flex; flex-direction: column; gap: 14px;">
                <div class="mapping-grid"><div class="mapping-left"><strong>Impact − Difficulty Score</strong><br><small style="color: var(--gray-500);">Decision tree root variable</small></div><div class="mapping-arrow">→</div><div class="mapping-right"><strong>Actor positions × influence weights</strong><br><small style="color: var(--gray-500);">Derived from power map quadrant analysis</small></div></div>
                <div class="mapping-grid"><div class="mapping-left"><strong>Political Control</strong><br><small style="color: var(--gray-500);">Split / D Trifecta / R Trifecta</small></div><div class="mapping-arrow">→</div><div class="mapping-right"><strong>State metadata layer</strong><br><small style="color: var(--gray-500);">Auto-populated from state political data</small></div></div>
                <div class="mapping-grid"><div class="mapping-left"><strong>Bipartisan Support</strong><br><small style="color: var(--gray-500);">Majority support for clean energy?</small></div><div class="mapping-arrow">→</div><div class="mapping-right"><strong>Cross-party ally count</strong><br><small style="color: var(--gray-500);">Readable from the power map</small></div></div>
                <div class="mapping-grid"><div class="mapping-left"><strong>Legislative Champions</strong><br><small style="color: var(--gray-500);">Clear leaders who will carry the work</small></div><div class="mapping-arrow">→</div><div class="mapping-right"><strong>Champion designation on actor nodes</strong><br><small style="color: var(--gray-500);">Distinct from allies — flagged for leadership</small>
                    <span class="cognitive-lineage" tabindex="0">🧠
                        <span class="tooltip">
                            <span class="tooltip-header">Champions ≠ Allies</span>
                            EAF distinguishes "champions who will lead" from mere supporters. The map needs this distinction — not just who supports, but who will put their name on it.
                            <span class="tooltip-source">Source: Campaign Workbook Rubric Q4</span>
                        </span>
                    </span>
                </small></div></div>
            </div>
        </div>

        <div class="feedback-zone reveal" data-section="decision-framework">
            <div class="feedback-header"><span>✋</span><h4>Your Turn — Decision Framework</h4></div>
            <p class="feedback-prompt">Does this capture how you actually use the decision tree and rubric? What variables are we missing?</p>
            <textarea class="feedback-textarea" placeholder="Your thoughts on how the power mapper should integrate with your existing evaluation workflow..."></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('decision-framework')">Submit Feedback</button>
                <span class="feedback-status" id="status-decision-framework"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 05 — Dual Power Map Model
     ================================================================ -->
<section id="dual-model">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">05</span>
            <h2>The Dual Power Map Model</h2>
            <p>A critical insight: EAF uses TWO complementary approaches to power mapping</p>
        </div>

        <div class="callout reveal">
            <p><strong>Key Discovery:</strong> By analyzing EAF's actual materials — particularly the Governors Power Map spreadsheet — we identified that your practice integrates two distinct but complementary models. The instrument must support both.</p>
        </div>

        <div class="dual-model-grid reveal">
            <div class="model-card model-a">
                <div class="model-header"><h3>Type A: Strategic Two-Axis Visualization</h3><p>From the contract scope</p></div>
                <div class="model-body">
                    <div class="model-visual">
                        <div class="axis-map">
                            <span class="axis-label top">High Influence</span>
                            <span class="axis-label bottom">Low Influence</span>
                            <span class="axis-label left">Opposition</span>
                            <span class="axis-label right">Ally</span>
                            <div class="quadrant top-left">Convert or<br>Neutralize</div>
                            <div class="quadrant top-right">Mobilize &amp;<br>Leverage</div>
                            <div class="quadrant bottom-left">Monitor</div>
                            <div class="quadrant bottom-right">Activate &amp;<br>Develop</div>
                        </div>
                    </div>
                    <h4 style="margin-bottom: 8px; font-family: 'Inter', sans-serif; font-size: 0.9rem;">Best For:</h4>
                    <ul style="list-style: none; font-size: 0.85rem; color: var(--gray-600);">
                        <li>→ Campaign-level strategic overview</li>
                        <li>→ Board presentations</li>
                        <li>→ Prioritizing engagement tactics</li>
                    </ul>
                </div>
            </div>
            <div class="model-card model-b">
                <div class="model-header"><h3>Type B: Relational Influence Matrix</h3><p>From the actual Governor/PUC spreadsheet</p></div>
                <div class="model-body">
                    <table class="matrix-table">
                        <thead><tr><th>Actor</th><th>Influence</th><th>Best Relationship</th></tr></thead>
                        <tbody>
                            <tr><td>Gov. Chief of Staff</td><td><span class="influence-score"><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span></span></td><td>State Partner</td></tr>
                            <tr><td>PUC Commissioner</td><td><span class="influence-score"><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot empty"></span></span></td><td>Coalition</td></tr>
                            <tr><td>Major Donor</td><td><span class="influence-score"><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot"></span><span class="influence-dot empty"></span><span class="influence-dot empty"></span></span></td><td>National</td></tr>
                        </tbody>
                    </table>
                    <h4 style="margin-bottom: 8px; font-family: 'Inter', sans-serif; font-size: 0.9rem; margin-top: 16px;">Best For:</h4>
                    <ul style="list-style: none; font-size: 0.85rem; color: var(--gray-600);">
                        <li>→ "Who can move whom" analysis</li>
                        <li>→ Identifying relationship gaps</li>
                        <li>→ Coordinating coalition outreach</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="reveal" style="text-align: center; margin-top: 28px;">
            <span class="cognitive-lineage" tabindex="0" style="font-size: 1.25rem;">🧠
                <span class="tooltip" style="text-align: left;">
                    <span class="tooltip-header">Cognitive Lineage</span>
                    Discovered by analyzing the Governors Powermap spreadsheet shared Feb 3, 2026. The relational influence matrix reveals that EAF's actual practice centers on "who-knows-whom," not just stance/influence positioning.
                    <span class="tooltip-source">Source: MI/PA/MD Power Map Spreadsheet, 5 sheets</span>
                </span>
            </span>
        </div>
        <div class="callout reveal" style="margin-top: 24px;">
            <p><strong>Key Insight from Prototyping:</strong> Our earlier prototype implemented only Type A — the two-axis chart. Testing revealed this isn't enough. EAF's actual practice, visible in the Governors Powermap spreadsheet, is fundamentally relational. The relational model isn't an add-on — it's the deeper truth about how EAF thinks about power.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Gap analysis conducted Feb 11, comparing Atlas V2 prototype against EAF's actual materials. The governors powermap spreadsheet (MI/PA/MD) proved that relational mapping is core to EAF's practice, not supplementary.
                        <span class="tooltip-source">Source: Gap Analysis — Atlas V2 vs Spec v3, Feb 2026</span>
                    </span>
                </span>
            </p>
        </div>

        <div class="feedback-zone reveal" data-section="dual-model">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">How do these two models relate in your work? Does one inform the other? Which is more valuable to your team?</p>
            <textarea class="feedback-textarea" placeholder="Tell us about how you currently use power maps... Do you build both types? In what order?" aria-label="Feedback for Dual Model section"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('dual-model')">Submit Feedback</button>
                <span class="feedback-status" id="status-dual-model"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 06 — Core Capabilities
     ================================================================ -->
<section id="capabilities">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">06</span>
            <h2>Core Capabilities</h2>
            <p>The essential capabilities that deliver on the vision</p>
        </div>

        <div class="card-grid reveal">
            <div class="card"><div class="card-header"><div class="card-icon">📄</div><div><h3>Document Parsing</h3><span class="card-tag">Foundation</span></div></div><p>Intelligent ingestion of campaign plans in multiple formats (PDF, PPTX, Google Docs). Extracts actors, organizations, relationships, and strategic context automatically.</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">🎯</div><div><h3>Actor Classification</h3><span class="card-tag">Intelligence</span></div></div><p>Scores each actor on stance (opposition to ally) and influence (1-5 scale). Categorizes by role: Inside Government, Political/Outside, Influential Donors, Coalition Partners.</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">🔗</div><div><h3>Relational Mapping</h3><span class="card-tag">Critical</span></div></div><p>Maps the "who-knows-whom" network. For each actor: who in your coalition has the best relationship? Where are the gaps?</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">🔍</div><div><h3>Gap Analysis</h3><span class="card-tag">Strategic</span></div></div><p>Identifies missing stakeholders AND relationship gaps. "You need access to the PUC chair but no one in your coalition has a direct line."</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">⚡</div><div><h3>Scenario Testing</h3><span class="card-tag">Dynamic</span></div></div><p>"What if the utility association goes neutral?" See cascade effects across your map. Model tipping points and identify which actors could trigger broader shifts.</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">💡</div><div><h3>Rationale Generation</h3><span class="card-tag">Transparency</span></div></div><p>Every placement comes with an explanation. "Placed Senator X as high-influence ally because: mentioned 3x in campaign plan as key champion."</p></div>
            <div class="card"><div class="card-header"><div class="card-icon">⭐</div><div><h3>Champion Designation</h3><span class="card-tag">Actor Layer</span></div></div><p>A distinct designation beyond ally/neutral/opposition. <strong>Champions</strong> are actors who will actively lead the legislative work — not just support it, but carry it.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        The EAF Campaign Workbook Rubric specifically asks about "clear legislative champions who will lead the work" — this is a first-order evaluation criterion, distinct from general support.
                        <span class="tooltip-source">Source: EAF Campaign Workbook Rubric, Tactics category</span>
                    </span>
                </span>
            </p></div>
            <div class="card"><div class="card-header"><div class="card-icon">⚖️</div><div><h3>Equity Overlay</h3><span class="card-tag">Justice Layer</span></div></div><p>Reveals which actors represent front-line communities, which pathways to victory run through those communities versus around them, and what happens when <strong>equity centering is treated as a constraint rather than an aspiration.</strong>
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Equity as Lens, Not Checkbox</span>
                        The current rubric asks equity as a yes/no. The power mapper could show what happens to the strategy if you center equity as a constraint — do different paths to victory emerge?
                        <span class="tooltip-source">Source: PBC contemplation on the rubric</span>
                    </span>
                </span>
            </p></div>
        </div>

        <div class="feedback-zone reveal" data-section="capabilities">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">Which capability is most important to get right first?</p>
            <textarea class="feedback-textarea" placeholder="If we could only nail ONE of these in Phase 1, which would have the biggest impact on your work?" aria-label="Feedback for Capabilities section"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('capabilities')">Submit Feedback</button>
                <span class="feedback-status" id="status-capabilities"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 07 — Agent Swarm Architecture
     ================================================================ -->
<section id="architecture">
    <div class="container">
        <div class="section-header reveal">
            <span class="section-number">07</span>
            <h2>Agent Swarm Architecture</h2>
            <p>How the system thinks: specialized AI agents working in coordination</p>
        </div>

        <div class="swarm-container reveal" id="swarmContainer">
            <svg class="swarm-svg" viewBox="0 0 900 560">
                <g stroke="#415a77" stroke-width="1.5" fill="none" opacity="0.4">
                    <line x1="450" y1="100" x2="160" y2="220"/><line x1="450" y1="100" x2="370" y2="240"/>
                    <line x1="450" y1="100" x2="530" y2="240"/><line x1="450" y1="100" x2="740" y2="220"/>
                    <line x1="160" y1="220" x2="370" y2="240"/><line x1="370" y1="240" x2="530" y2="240"/>
                    <line x1="530" y1="240" x2="400" y2="380"/><line x1="400" y1="380" x2="560" y2="380"/>
                    <line x1="560" y1="380" x2="450" y2="490"/><line x1="240" y1="380" x2="450" y2="490"/>
                    <line x1="370" y1="240" x2="240" y2="380"/><line x1="450" y1="490" x2="740" y2="400"/>
                </g>
                <defs>
                    <linearGradient id="navyGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#2d4a7c"/><stop offset="100%" style="stop-color:#1a365d"/></linearGradient>
                    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#ed8936"/><stop offset="100%" style="stop-color:#dd6b20"/></linearGradient>
                </defs>
                <g><circle cx="450" cy="100" r="40" fill="url(#orangeGrad)"/><text x="450" y="96" text-anchor="middle" fill="white" font-size="20">🎛️</text><text x="450" y="115" text-anchor="middle" fill="white" font-size="10" font-family="Inter,sans-serif">Orchestrator</text></g>
                <g><circle cx="160" cy="220" r="34" fill="url(#navyGrad)"/><text x="160" y="216" text-anchor="middle" fill="white" font-size="18">📄</text><text x="160" y="234" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Doc Parser</text></g>
                <g><circle cx="370" cy="240" r="34" fill="url(#navyGrad)"/><text x="370" y="236" text-anchor="middle" fill="white" font-size="18">🎯</text><text x="370" y="254" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Actor ID</text></g>
                <g><circle cx="530" cy="240" r="34" fill="url(#navyGrad)"/><text x="530" y="236" text-anchor="middle" fill="white" font-size="18">🔗</text><text x="530" y="254" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Relational</text></g>
                <g><circle cx="740" cy="220" r="34" fill="url(#navyGrad)"/><text x="740" y="216" text-anchor="middle" fill="white" font-size="18">🌐</text><text x="740" y="234" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Enricher</text></g>
                <g><circle cx="240" cy="380" r="34" fill="url(#navyGrad)"/><text x="240" y="376" text-anchor="middle" fill="white" font-size="18">💡</text><text x="240" y="394" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Rationale</text></g>
                <g><circle cx="400" cy="380" r="34" fill="url(#navyGrad)"/><text x="400" y="376" text-anchor="middle" fill="white" font-size="18">🔍</text><text x="400" y="394" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Gap Analyst</text></g>
                <g><circle cx="560" cy="380" r="34" fill="url(#navyGrad)"/><text x="560" y="376" text-anchor="middle" fill="white" font-size="18">⚡</text><text x="560" y="394" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Scenario</text></g>
                <g><circle cx="450" cy="490" r="36" fill="url(#navyGrad)"/><text x="450" y="486" text-anchor="middle" fill="white" font-size="18">📝</text><text x="450" y="504" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Narrative</text></g>
                <g><circle cx="740" cy="400" r="34" fill="url(#orangeGrad)"/><text x="740" y="396" text-anchor="middle" fill="white" font-size="18">📤</text><text x="740" y="414" text-anchor="middle" fill="white" font-size="9" font-family="Inter,sans-serif">Export</text></g>
            </svg>
        </div>

        <div class="reveal" style="text-align: center; margin-top: 20px;">
            <span class="cognitive-lineage" tabindex="0" style="font-size: 1.25rem;">🧠
                <span class="tooltip" style="text-align: left;">
                    <span class="tooltip-header">Cognitive Lineage</span>
                    Architecture designed based on Ryan's workflow description and analysis of the State Planning Workbook structure. The agent decomposition maps directly to the stages Ryan described in the discovery call.
                    <span class="tooltip-source">Source: Discovery call transcript 00:32-00:39, State Planning Workbook 2026</span>
                </span>
            </span>
        </div>

        <div class="callout reveal" style="margin-top: 24px;">
            <p><strong>Build Philosophy:</strong> An earlier prototype demonstrated that the interaction model works — three-panel layout, drag-and-drop, natural language queries, missing actor suggestions. This architecture represents a rebuild from specification, delivering a stronger foundation.
                <span class="cognitive-lineage" tabindex="0">🧠
                    <span class="tooltip">
                        <span class="tooltip-header">Cognitive Lineage</span>
                        Decision made after gap analysis comparing V2 prototype (Feb 4) against spec v3. Key finding: all V2 features were the simple version of things the spec describes the full version of. Rebuild delivers a stronger foundation than extending.
                        <span class="tooltip-source">Source: Gap Analysis, Feb 2026; V2 prototype review</span>
                    </span>
                </span>
            </p>
        </div>

        <div class="feedback-zone reveal" data-section="architecture">
            <div class="feedback-header"><span>✋</span><h4>Your Turn</h4></div>
            <p class="feedback-prompt">Are there parts of your process we're not capturing in this architecture?</p>
            <textarea class="feedback-textarea" placeholder="What steps happen in your workflow that we haven't accounted for?" aria-label="Feedback for Architecture section"></textarea>
            <div class="feedback-actions">
                <button class="feedback-btn" onclick="submitFeedback('architecture')">Submit Feedback</button>
                <span class="feedback-status" id="status-architecture"></span>
            </div>
        </div>
    </div>
</section>

<!-- ================================================================
     SECTION 08 — Context Materials Status
     ================================================================ -->
        <section id="materials">
            <div class="container">
                <div class="section-header reveal">
                    <span class="section-number">08</span>
                    <h2>Context Materials Status</h2>
                    <p>What we have, what we still need</p>
                </div>
                <div class="callout reveal" style="margin-bottom: 28px;">
                    <p>📁 <strong>Shared Google Drive:</strong> <a href="https://drive.google.com/drive/folders/1fpjhEvCI-fa_S5jgYqSFXtl64SXfpHbc" target="_blank" style="color: var(--orange-dark); text-decoration: underline;">EAF Materials Folder</a> — The State Planning Workbook and campaign plans are here. Any additional content can be shared in this folder and we'll incorporate it into the build.</p>
                </div>
                <div class="checklist reveal">
                    <div class="checklist-group">
                        <h3><span class="check-icon done">✓</span> Received</h3>
                        <ul class="checklist-items">
                            <li><span class="check-icon done">✓</span><div><strong>State Planning Workbook 2026</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">PDF, 21 pages</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Good Plan: Minnesota</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">49 slides</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Strong Plan: California</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">64 slides</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Weak Plan: Iowa</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">36 slides</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Bad Plan: Wisconsin</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">36 slides</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Gubernatorial Power Map Spreadsheet</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">Excel, 5 sheets with MI/PA/MD data</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Discovery Call Transcript</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">Jan 30, 2026</span></div></li>
                            <li><span class="check-icon done">✓</span><div><strong>Signed Contract</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">Nov 18, 2025</span></div></li>
                        </ul>
                    </div>
                    <div class="checklist-group">
                        <h3><span class="check-icon pending">⏳</span> Still Needed</h3>
                        <ul class="checklist-items">
                            <li><span class="check-icon pending">⏳</span><div><strong>Tom's Quantitative Scoring Matrix</strong><br><span style="font-size: 0.8rem; color: var(--orange);">Critical for TomBot module</span></div></li>
                            <li><span class="check-icon pending">⏳</span><div><strong>Additional Strategic Frameworks</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">How EAF evaluates campaign quality</span></div></li>
                            <li><span class="check-icon pending">⏳</span><div><strong>Adrianna's Materials</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">From fall Power Surge convening</span></div></li>
                            <li><span class="check-icon pending">⏳</span><div><strong>More Power Map Examples</strong><br><span style="font-size: 0.8rem; color: var(--gray-500);">Legislative/regulatory (not just gubernatorial)</span></div></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

<!-- ================================================================
     FOOTER
     ================================================================ -->
<footer style="background: var(--navy-dark); color: var(--gray-400); padding: 48px 0; text-align: center;">
    <div class="container">
        <div style="font-family: 'Inter', sans-serif; font-size: 0.8rem; letter-spacing: 0.15em; color: var(--orange-light); margin-bottom: 8px; text-transform: lowercase;">empire</div>
        <h3 style="color: var(--white); font-size: 1.3rem; margin-bottom: 8px;">This Document Is Alive</h3>
        <p style="max-width: 500px; margin: 0 auto 24px; font-size: 0.9rem; line-height: 1.7;">
            Your feedback doesn't just get filed. It cascades through every section, reshaping what gets built.
            The next version of this document will reflect what you tell us today.
        </p>
        <div style="font-size: 0.78rem; color: var(--gray-600);">
            Energy Action Fund × empire | Living Product Specification | February 2026
        </div>
    </div>
</footer>

<!-- ================================================================
     FLOATING UI ELEMENTS
     ================================================================ -->
<button class="glossary-fab" onclick="toggleGlossary()" aria-label="Open terminology glossary" title="Glossary">📖</button>

<div class="glossary-overlay" id="glossaryOverlay" onclick="toggleGlossary()"></div>
<div class="glossary-panel" id="glossaryPanel">
    <div class="glossary-panel-header">
        <h3>Terminology Bridge</h3>
        <button class="glossary-close" onclick="toggleGlossary()" aria-label="Close glossary">&times;</button>
    </div>
    <p style="font-size: 0.88rem; color: var(--gray-600); margin-bottom: 20px; line-height: 1.65;">
        We use some specific language in this document. Here's what each term means in your world.
    </p>
    <div class="glossary-item"><div class="glossary-term">Cognitive Lineage</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">Tracking who contributed what insight and how it evolved — like citing your sources, but for strategic thinking.</div></div>
    <div class="glossary-item"><div class="glossary-term">Essential Experience</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">What the instrument should <em>feel like</em> to use — not just what it does, but the experience of using it.</div></div>
    <div class="glossary-item"><div class="glossary-term">Alliance Economics</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">Building so that everyone gets more capable — not just the builder. Your team's expertise makes the instrument smarter; the instrument makes your team faster.</div></div>
    <div class="glossary-item"><div class="glossary-term">Hidden Games</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">The real dynamics beneath surface positions. A legislator who publicly opposes a bill but privately signals flexibility — that gap is the hidden game.</div></div>
    <div class="glossary-item"><div class="glossary-term">Positive-Sum Power</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">Approaches where everyone gains capacity. When your mapping instrument helps a grantee run better campaigns, and their success validates EAF's strategy — that's positive-sum.</div></div>
    <div class="glossary-item"><div class="glossary-term">Agent Swarm</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">The AI team that processes your campaign plans — multiple specialized AI agents working together, each handling a different analytical task, coordinated into a single result.</div></div>
    <div class="glossary-item"><div class="glossary-term">Dual Model</div><div class="glossary-arrow">In your world:</div><div class="glossary-plain">Two complementary views of the power landscape — one showing relationships and influence networks, the other showing positions and alignment on specific issues.</div></div>
</div>

<button class="review-fab" id="reviewFab" onclick="showReviewPanel()">
    📋 Review Feedback <span class="review-count" id="reviewCount">0</span>
</button>

<!-- ================================================================
     TESSERACT NAVIGATOR — Compact (floating)
     "Progress bar meets tesseract meets TARDIS"
     ================================================================ -->
<div class="tesseract-nav" id="tesseractNav" onclick="toggleTesseract()">
    <div class="tesseract-compact">
        <!-- Progress ring -->
        <svg class="tesseract-progress" viewBox="0 0 80 80">
            <circle class="progress-bg" cx="40" cy="40" r="37"/>
            <circle class="progress-fill" id="progressRing" cx="40" cy="40" r="37"
                    stroke-dasharray="232.5" stroke-dashoffset="232.5"/>
        </svg>
        <!-- Tesseract wireframe -->
        <svg class="tesseract-svg" viewBox="0 0 48 48">
            <!-- Outer square -->
            <line class="tesseract-edge" x1="6" y1="6" x2="42" y2="6"/>
            <line class="tesseract-edge" x1="42" y1="6" x2="42" y2="42"/>
            <line class="tesseract-edge" x1="42" y1="42" x2="6" y2="42"/>
            <line class="tesseract-edge" x1="6" y1="42" x2="6" y2="6"/>
            <!-- Inner square -->
            <line class="tesseract-edge inner" x1="16" y1="16" x2="32" y2="16"/>
            <line class="tesseract-edge inner" x1="32" y1="16" x2="32" y2="32"/>
            <line class="tesseract-edge inner" x1="32" y1="32" x2="16" y2="32"/>
            <line class="tesseract-edge inner" x1="16" y1="32" x2="16" y2="16"/>
            <!-- Cross connections (outer → inner) -->
            <line class="tesseract-edge cross" x1="6" y1="6" x2="16" y2="16"/>
            <line class="tesseract-edge cross" x1="42" y1="6" x2="32" y2="16"/>
            <line class="tesseract-edge cross" x1="42" y1="42" x2="32" y2="32"/>
            <line class="tesseract-edge cross" x1="6" y1="42" x2="16" y2="32"/>
            <!-- Center spokes -->
            <line class="tesseract-edge cross" x1="16" y1="16" x2="24" y2="24"/>
            <line class="tesseract-edge cross" x1="32" y1="16" x2="24" y2="24"/>
            <line class="tesseract-edge cross" x1="32" y1="32" x2="24" y2="24"/>
            <line class="tesseract-edge cross" x1="16" y1="32" x2="24" y2="24"/>
            <!-- Vertices — each maps to a spec section -->
            <circle class="tesseract-vertex" data-section="section-00" cx="6" cy="6" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="executive-vision" cx="42" cy="6" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="essential-experiences" cx="42" cy="42" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="user-journey" cx="6" cy="42" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="section-04" cx="16" cy="16" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="dual-model" cx="32" cy="16" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="capabilities" cx="32" cy="32" r="2.5" fill="rgba(255,255,255,0.3)"/>
            <circle class="tesseract-vertex" data-section="architecture" cx="16" cy="32" r="2.5" fill="rgba(255,255,255,0.3)"/>

        </svg>
        <!-- Tooltip on hover -->
        <div class="tesseract-tooltip" id="tesseractTooltip">
            <span class="tt-section" id="ttSection">Portal to the Alliance</span>
            <span class="tt-progress" id="ttProgress">0 of 7 sections enlivened</span>
        </div>
    </div>
</div>

<!-- ================================================================
     TESSERACT EXPANDED — The TARDIS View
     "Bigger on the inside"
     ================================================================ -->
<div class="tesseract-overlay" id="tesseractOverlay">
    <button class="tesseract-close" onclick="closeTesseract()" aria-label="Close tesseract">&times;</button>
    <div class="tesseract-expanded">
        <div class="expanded-header">
            <h2>Causal Dependency Map</h2>
            <p>Every section shapes what follows. Your feedback cascades through the entire system.</p>
            <div class="expanded-score">
                <span class="score-num" id="enlivenScore">0</span>
                <span class="score-label">of 7 sections enlivened</span>
            </div>
        </div>
        <div class="dep-map">
            <!-- PHASE C: Organic dep map — ellipse nodes, cubic-Bezier edges, particle flow -->
            <svg viewBox="0 0 800 380" id="depMapSvg">
                <defs>
                    <!-- Arrowhead markers -->
                    <marker id="arrowhead" markerWidth="7" markerHeight="5"
                            refX="6" refY="2.5" orient="auto">
                        <polygon points="0 0, 7 2.5, 0 5" fill="rgba(255,255,255,0.18)"/>
                    </marker>
                    <marker id="arrowheadActive" markerWidth="7" markerHeight="5"
                            refX="6" refY="2.5" orient="auto">
                        <polygon points="0 0, 7 2.5, 0 5" fill="var(--amber)"/>
                    </marker>

                    <!-- Radial gradients per section accent color -->
                    <radialGradient id="grad-executive-vision" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#f6ad55" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#ed8936" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-essential-experiences" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#a78bfa" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#7c3aed" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-dual-model" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#f9a8d4" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#ec4899" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-section-04" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#93c5fd" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#3b82f6" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-user-journey" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#5eead4" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#14b8a6" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-architecture" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#2dd4bf" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#0d9488" stop-opacity="0.75"/>
                    </radialGradient>
                    <radialGradient id="grad-capabilities" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#a5b4fc" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#6366f1" stop-opacity="0.75"/>
                    </radialGradient>
                    <!-- Enlivened amber fill (referenced by JS) -->
                    <radialGradient id="depAmber" cx="50%" cy="40%" r="60%">
                        <stop offset="0%"   stop-color="#fbbf24"/>
                        <stop offset="100%" stop-color="#d97706"/>
                    </radialGradient>

                    <!-- Named paths for animateMotion particles -->
                    <path id="flow-path-ev-ee"  d="M 200,54 C 240,44 270,64 310,54"/>
                    <path id="flow-path-ee-dm"  d="M 490,54 C 530,38 560,38 600,54"/>
                </defs>

                <!-- Dependency edges — cubic Bezier paths -->
                <g class="dep-edges">
                    <path class="dep-edge dep-edge-path"
                          data-from="executive-vision" data-to="essential-experiences"
                          d="M 200,54 C 240,44 270,64 310,54"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="essential-experiences" data-to="dual-model"
                          d="M 490,54 C 530,38 560,38 600,54"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="executive-vision" data-to="section-04"
                          d="M 130,78 C 115,105 115,125 130,135"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="essential-experiences" data-to="user-journey"
                          d="M 400,78 C 385,105 385,125 400,135"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="dual-model" data-to="architecture"
                          d="M 670,78 C 685,105 685,125 670,135"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="user-journey" data-to="section-04"
                          d="M 320,159 C 290,146 240,172 210,159"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="user-journey" data-to="architecture"
                          d="M 480,159 C 510,172 560,146 590,159"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="section-04" data-to="capabilities"
                          d="M 145,183 C 145,220 230,248 260,258"
                          marker-end="url(#arrowhead)"/>
                    <path class="dep-edge dep-edge-path"
                          data-from="architecture" data-to="capabilities"
                          d="M 655,183 C 600,230 420,248 350,258"
                          marker-end="url(#arrowhead)"/>
                </g>

                <!-- Flowing particles along key edges -->
                <circle class="dep-flow-particle" r="3">
                    <animateMotion dur="3.2s" repeatCount="indefinite" begin="0.5s">
                        <mpath href="#flow-path-ev-ee"/>
                    </animateMotion>
                </circle>
                <circle class="dep-flow-particle" r="3">
                    <animateMotion dur="3.8s" repeatCount="indefinite" begin="1.1s">
                        <mpath href="#flow-path-ee-dm"/>
                    </animateMotion>
                </circle>

                <!-- Section nodes — organic ellipses with per-section radial gradients -->
                <!-- Row 1 -->
                <g class="dep-node" data-section="executive-vision" onclick="depNodeClick('executive-vision')">
                    <ellipse class="dep-node-bg" cx="130" cy="54" rx="75" ry="26" fill="url(#grad-executive-vision)"/>
                    <text class="dep-node-num"   x="130" y="49" text-anchor="middle">01</text>
                    <text class="dep-node-label" x="130" y="62" text-anchor="middle">Executive Vision</text>
                </g>
                <g class="dep-node" data-section="essential-experiences" onclick="depNodeClick('essential-experiences')">
                    <ellipse class="dep-node-bg" cx="400" cy="54" rx="75" ry="26" fill="url(#grad-essential-experiences)"/>
                    <text class="dep-node-num"   x="400" y="49" text-anchor="middle">02</text>
                    <text class="dep-node-label" x="400" y="62" text-anchor="middle">Essential Exp.</text>
                </g>
                <g class="dep-node" data-section="dual-model" onclick="depNodeClick('dual-model')">
                    <ellipse class="dep-node-bg" cx="670" cy="54" rx="75" ry="26" fill="url(#grad-dual-model)"/>
                    <text class="dep-node-num"   x="670" y="49" text-anchor="middle">05</text>
                    <text class="dep-node-label" x="670" y="62" text-anchor="middle">Dual Model</text>
                </g>
                <!-- Row 2 -->
                <g class="dep-node" data-section="section-04" onclick="depNodeClick('section-04')">
                    <ellipse class="dep-node-bg" cx="130" cy="159" rx="75" ry="26" fill="url(#grad-section-04)"/>
                    <text class="dep-node-num"   x="130" y="154" text-anchor="middle">04</text>
                    <text class="dep-node-label" x="130" y="167" text-anchor="middle">Decision Framework</text>
                </g>
                <g class="dep-node" data-section="user-journey" onclick="depNodeClick('user-journey')">
                    <ellipse class="dep-node-bg" cx="400" cy="159" rx="75" ry="26" fill="url(#grad-user-journey)"/>
                    <text class="dep-node-num"   x="400" y="154" text-anchor="middle">03</text>
                    <text class="dep-node-label" x="400" y="167" text-anchor="middle">User Journey</text>
                </g>
                <g class="dep-node" data-section="architecture" onclick="depNodeClick('architecture')">
                    <ellipse class="dep-node-bg" cx="670" cy="159" rx="75" ry="26" fill="url(#grad-architecture)"/>
                    <text class="dep-node-num"   x="670" y="154" text-anchor="middle">07</text>
                    <text class="dep-node-label" x="670" y="167" text-anchor="middle">Architecture</text>
                </g>
                <!-- Row 3 -->
                <g class="dep-node" data-section="capabilities" onclick="depNodeClick('capabilities')">
                    <ellipse class="dep-node-bg" cx="270" cy="269" rx="75" ry="26" fill="url(#grad-capabilities)"/>
                    <text class="dep-node-num"   x="270" y="264" text-anchor="middle">06</text>
                    <text class="dep-node-label" x="270" y="277" text-anchor="middle">Capabilities</text>
                </g>
            </svg>
        </div>
        <!-- Delivery milestones -->
        <div class="dep-delivery">
            <div class="dep-milestone">
                <div class="dep-milestone-dot now">📄</div>
                <div class="dep-milestone-label">Your Input Today</div>
                <div class="dep-milestone-date">Wed, Feb 25</div>
            </div>
            <div class="dep-milestone">
                <div class="dep-milestone-dot future">🔧</div>
                <div class="dep-milestone-label">Updated Prototype</div>
                <div class="dep-milestone-date">Fri, Feb 27</div>
            </div>
            <div class="dep-milestone">
                <div class="dep-milestone-dot future">🎯</div>
                <div class="dep-milestone-label">Board-Ready</div>
                <div class="dep-milestone-date">Tue, Mar 3</div>
            </div>
        </div>
    </div>
</div>

<!-- ================================================================
     JAVASCRIPT — Scroll reveals, Glossary, Feedback
     ================================================================ -->
<script>
// Scroll reveal system
const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
        }
    });
}, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

// ================================================================
// PHASE F — Stagger Index Assignment + Granular Reveals
// ================================================================
(function() {
    // Card grids: assign --stagger-index to each card
    document.querySelectorAll('.card-grid').forEach(function(grid) {
        var cards = grid.querySelectorAll('.card');
        cards.forEach(function(card, i) {
            card.style.setProperty('--stagger-index', i);
            if (!card.classList.contains('reveal')) {
                card.classList.add('reveal');
            }
            revealObserver.observe(card);
        });
    });

    // Journey steps: break into individual reveals
    document.querySelectorAll('.journey-steps').forEach(function(list) {
        var steps = list.querySelectorAll('.journey-step');
        steps.forEach(function(step, i) {
            if (!step.classList.contains('reveal')) {
                step.classList.add('reveal');
            }
            step.style.transitionDelay = (i * 120) + 'ms';
            revealObserver.observe(step);
        });
    });

    // Quote blocks: ensure each is individually observed
    document.querySelectorAll('.quote-block').forEach(function(q) {
        if (!q.classList.contains('reveal')) {
            q.classList.add('reveal');
            revealObserver.observe(q);
        }
    });

    // Split cards: staggered pair
    document.querySelectorAll('.split-grid').forEach(function(grid) {
        var cards = grid.querySelectorAll('.split-card');
        cards.forEach(function(card, i) {
            if (!card.classList.contains('reveal')) {
                card.classList.add('reveal');
            }
            card.style.transitionDelay = (i * 150) + 'ms';
            revealObserver.observe(card);
        });
    });

    // Swarm container: confirm reveal
    var swarm = document.querySelector('.swarm-container');
    if (swarm && !swarm.classList.contains('reveal')) {
        swarm.classList.add('reveal');
        revealObserver.observe(swarm);
    }
})();

// Glossary toggle
function toggleGlossary() {
    const panel = document.getElementById('glossaryPanel');
    const overlay = document.getElementById('glossaryOverlay');
    panel.classList.toggle('open');
    overlay.classList.toggle('open');
    document.body.style.overflow = panel.classList.contains('open') ? 'hidden' : '';
}

document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
        const panel = document.getElementById('glossaryPanel');
        if (panel && panel.classList.contains('open')) toggleGlossary();
    }
});

// Feedback system with localStorage
function submitFeedback(sectionId) {
    const zone = document.querySelector(`[data-section="${sectionId}"]`);
    if (!zone) return;
    const textarea = zone.querySelector('.feedback-textarea');
    const status = document.getElementById(`status-${sectionId}`);
    const value = textarea.value.trim();
    if (!value) return;

    // Section title lookup
    const sectionTitles = {
        'executive-vision': 'Executive Vision',
        'essential-experiences': 'Essential Experiences',
        'user-journey': 'User Journey',
        'decision-framework': 'Decision Framework',
        'dual-model': 'Dual Power Map Model',
        'capabilities': 'Core Capabilities',
        'architecture': 'Agent Swarm Architecture'
    };

    // Save to localStorage (offline backup)
    const feedbackStore = JSON.parse(localStorage.getItem('eaf-feedback') || '{}');
    feedbackStore[sectionId] = { text: value, timestamp: new Date().toISOString() };
    localStorage.setItem('eaf-feedback', JSON.stringify(feedbackStore));

    // POST to Google Sheet (fire-and-forget, non-blocking)
    const SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycby3ZX3-O8PU1PjGHv-zGSEUSvxiFH8QuNBBe3A4QyW9xfSBc5j5N7GVPcumj_ifQkev/exec';
    try {
        fetch(SHEET_ENDPOINT, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'text/plain' },
            body: JSON.stringify({
                section: sectionId,
                sectionTitle: sectionTitles[sectionId] || sectionId,
                text: value
            })
        }).catch(function() { /* silent fail — localStorage has the backup */ });
    } catch(e) { /* silent fail */ }

    // Visual confirmation
    zone.classList.add('submitted');
    if (status) {
        status.textContent = '\u2705 Saved — your feedback is shaping the build';
        setTimeout(() => { status.textContent = ''; }, 4000);
    }

    updateReviewCount();
}

// Auto-save on input
document.querySelectorAll('.feedback-textarea').forEach(textarea => {
    const zone = textarea.closest('.feedback-zone');
    if (!zone) return;
    const sectionId = zone.dataset.section;

    // Load saved feedback
    const feedbackStore = JSON.parse(localStorage.getItem('eaf-feedback') || '{}');
    if (feedbackStore[sectionId]) {
        textarea.value = feedbackStore[sectionId].text;
    }
});

function updateReviewCount() {
    const feedbackStore = JSON.parse(localStorage.getItem('eaf-feedback') || '{}');
    const count = Object.keys(feedbackStore).length;
    const el = document.getElementById('reviewCount');
    if (el) el.textContent = count;
}

function showReviewPanel() {
    const feedbackStore = JSON.parse(localStorage.getItem('eaf-feedback') || '{}');
    const entries = Object.entries(feedbackStore);
    if (entries.length === 0) {
        alert('No feedback submitted yet. Use the "Your Turn" boxes throughout the document to share your thoughts.');
        return;
    }
    let msg = 'Your Feedback Summary:\n\n';
    entries.forEach(([section, data]) => {
        msg += `[${section}]\n${data.text}\n\n`;
    });
    alert(msg);
}

updateReviewCount();

// ================================================================
// TESSERACT NAVIGATOR — Enlivenment Engine
// ================================================================

const SECTIONS = [
    { id: 'section-00', label: 'Portal to the Alliance', feedbackKey: null },
    { id: 'executive-vision', label: 'Executive Vision', feedbackKey: 'executive-vision' },
    { id: 'essential-experiences', label: 'Essential Experiences', feedbackKey: 'essential-experiences' },
    { id: 'user-journey', label: 'User Journey', feedbackKey: 'user-journey' },
    { id: 'section-04', label: 'Decision Framework', feedbackKey: 'decision-framework' },
    { id: 'dual-model', label: 'Dual Power Map Model', feedbackKey: 'dual-model' },
    { id: 'capabilities', label: 'Core Capabilities', feedbackKey: 'capabilities' },
    { id: 'architecture', label: 'Agent Swarm Architecture', feedbackKey: 'architecture' }
];

// Causal dependency map: section → downstream sections it affects
const DEPENDENCIES = {
    'executive-vision': ['essential-experiences', 'section-04'],
    'essential-experiences': ['dual-model', 'user-journey'],
    'user-journey': ['section-04', 'architecture'],
    'section-04': ['capabilities'],
    'dual-model': ['architecture'],
    'capabilities': [],
    'architecture': ['capabilities']
};

let currentSectionId = 'section-00';

// Track which section is currently in view
const sectionObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting && entry.intersectionRatio > 0.2) {
            currentSectionId = entry.target.id;
            updateTesseractState();
        }
    });
}, { threshold: 0.2, rootMargin: '-10% 0px -40% 0px' });

SECTIONS.forEach(s => {
    const el = document.getElementById(s.id);
    if (el) sectionObserver.observe(el);
});

function getEnlivenedSections() {
    const store = JSON.parse(localStorage.getItem('eaf-feedback') || '{}');
    return new Set(Object.keys(store));
}

function updateTesseractState() {
    const enlivened = getEnlivenedSections();
    const current = SECTIONS.find(s => s.id === currentSectionId);

    // Update compact vertices
    document.querySelectorAll('.tesseract-vertex').forEach(v => {
        const sId = v.dataset.section;
        v.classList.remove('current', 'enlivened');
        v.setAttribute('fill', 'rgba(255,255,255,0.3)');
        const sec = SECTIONS.find(s => s.id === sId);
        if (sec && sec.feedbackKey && enlivened.has(sec.feedbackKey)) {
            v.classList.add('enlivened');
        }
        if (sId === currentSectionId) {
            v.classList.add('current');
        }
    });

    // Update tooltip
    const ttSection = document.getElementById('ttSection');
    const ttProgress = document.getElementById('ttProgress');
    if (ttSection && current) ttSection.textContent = current.label;
    const count = SECTIONS.filter(s => s.feedbackKey && enlivened.has(s.feedbackKey)).length;
    if (ttProgress) ttProgress.textContent = `${count} of 7 sections enlivened`;

    // Update progress ring
    const circumference = 2 * Math.PI * 37; // ~232.5
    const offset = circumference - (count / 7) * circumference;
    const ring = document.getElementById('progressRing');
    if (ring) ring.style.strokeDashoffset = offset;

    // Update expanded view
    const scoreEl = document.getElementById('enlivenScore');
    if (scoreEl) scoreEl.textContent = count;

    // Update dependency map nodes
    // Phase C: non-enlivened nodes restore their per-section radial gradient;
    //          enlivened nodes get the amber gradient for visual feedback.
    document.querySelectorAll('#depMapSvg .dep-node').forEach(node => {
        const sId = node.dataset.section;
        const sec = SECTIONS.find(s => s.id === sId);
        node.classList.remove('enlivened');
        const bg = node.querySelector('.dep-node-bg');
        if (sec && sec.feedbackKey && enlivened.has(sec.feedbackKey)) {
            node.classList.add('enlivened');
            if (bg) bg.setAttribute('fill', 'url(#depAmber)');
        } else {
            // Restore per-section radial gradient (Phase C organic nodes)
            if (bg) bg.setAttribute('fill', 'url(#grad-' + sId + ')');
        }
    });

    // Update dependency map edges
    document.querySelectorAll('#depMapSvg .dep-edge').forEach(edge => {
        const from = edge.dataset.from;
        const sec = SECTIONS.find(s => s.id === from);
        edge.classList.remove('enlivened');
        if (sec && sec.feedbackKey && enlivened.has(sec.feedbackKey)) {
            edge.classList.add('enlivened');
            edge.setAttribute('marker-end', 'url(#arrowheadActive)');
        } else {
            edge.setAttribute('marker-end', 'url(#arrowhead)');
        }
    });
}

// Cascade animation when feedback is submitted
function triggerCascade(sectionId) {
    // Find this section's feedbackKey → downstream dependencies
    const sec = SECTIONS.find(s => s.feedbackKey === sectionId);
    if (!sec) return;

    // Pulse the vertex on the compact tesseract
    const vertex = document.querySelector(`.tesseract-vertex[data-section="${sec.id}"]`);
    if (vertex) {
        vertex.classList.add('pulsing');
        setTimeout(() => vertex.classList.remove('pulsing'), 2500);
    }

    // Cascade through dependency edges in the expanded map
    const downstream = DEPENDENCIES[sec.id] || [];
    downstream.forEach((targetId, i) => {
        setTimeout(() => {
            const edge = document.querySelector(`.dep-edge[data-from="${sec.id}"][data-to="${targetId}"]`);
            if (edge) {
                edge.classList.add('cascading');
                setTimeout(() => edge.classList.remove('cascading'), 1500);
            }
        }, i * 300);
    });

    updateTesseractState();
}

// Override submitFeedback to hook cascade animation
const _originalSubmitFeedback = submitFeedback;
submitFeedback = function(sectionId) {
    _originalSubmitFeedback(sectionId);
    triggerCascade(sectionId);
};

// Tesseract expand/collapse with JS-driven path drawing
function animateDepPaths(show) {
    var paths = document.querySelectorAll('#depMapSvg .dep-edge-path');
    paths.forEach(function(p, i) {
        var len = p.getTotalLength ? p.getTotalLength() : 450;
        // Use CSS style properties (not SVG attributes) so CSS transition works
        p.style.strokeDasharray = len;
        if (show) {
            p.style.transition = 'none';
            p.style.strokeDashoffset = len;
            // Force reflow so the browser registers the starting value
            p.getBoundingClientRect();
            // Stagger the draw-in: 120ms apart
            setTimeout(function() {
                p.style.transition = 'stroke-dashoffset 1.1s cubic-bezier(0.16, 1, 0.3, 1)';
                p.style.strokeDashoffset = '0';
            }, 150 + i * 120);
        } else {
            p.style.transition = 'none';
            p.style.strokeDashoffset = len;
        }
    });
}

function toggleTesseract() {
    var overlay = document.getElementById('tesseractOverlay');
    overlay.classList.add('open');
    document.body.style.overflow = 'hidden';
    updateTesseractState();
    // Animate paths drawing in
    animateDepPaths(true);
}

function closeTesseract() {
    var overlay = document.getElementById('tesseractOverlay');
    overlay.classList.remove('open');
    document.body.style.overflow = '';
    // Reset paths after overlay fades out
    setTimeout(function() { animateDepPaths(false); }, 400);
}

// Click on dependency map node → scroll to section
function depNodeClick(sectionId) {
    closeTesseract();
    setTimeout(() => {
        const el = document.getElementById(sectionId);
        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 400);
}

// Close expanded on Escape
document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
        const overlay = document.getElementById('tesseractOverlay');
        if (overlay && overlay.classList.contains('open')) closeTesseract();
    }
});

// Inject cascade indicators above each feedback zone
function injectCascadeIndicators() {
    const sectionToFeedback = {
        'executive-vision': 'executive-vision',
        'essential-experiences': 'essential-experiences',
        'user-journey': 'user-journey',
        'section-04': 'decision-framework',
        'dual-model': 'dual-model',
        'capabilities': 'capabilities',
        'architecture': 'architecture'
    };
    const feedbackToSection = {};
    Object.entries(sectionToFeedback).forEach(([sId, fKey]) => feedbackToSection[fKey] = sId);

    document.querySelectorAll('.feedback-zone').forEach(zone => {
        const fKey = zone.dataset.section;
        const sId = feedbackToSection[fKey];
        if (!sId || !DEPENDENCIES[sId]) return;
        const downstream = DEPENDENCIES[sId];
        if (downstream.length === 0) return;
        const targets = downstream.map(dId => {
            const sec = SECTIONS.find(s => s.id === dId);
            return sec ? sec.label : dId;
        }).join(', ');
        const indicator = document.createElement('div');
        indicator.className = 'cascade-indicator';
        indicator.innerHTML = `<svg viewBox="0 0 16 16" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M8 2v8m0 0l-3-3m3 3l3-3M2 14h12"/></svg>This feedback shapes → <span class="cascade-targets">${targets}</span>`;
        zone.insertBefore(indicator, zone.querySelector('.feedback-prompt'));
    });
}
injectCascadeIndicators();

// Initialize state
updateTesseractState();

// ================================================================
// HERO — Character-Split Title + Typewriter Subtitle
// ================================================================
(function() {
    const title = document.getElementById('heroTitle');
    if (!title) return;
    const text = title.textContent;
    title.textContent = '';
    title.style.opacity = '1';
    let charIndex = 0;
    for (let i = 0; i < text.length; i++) {
        if (text[i] === ' ') {
            const space = document.createElement('span');
            space.className = 'char-space';
            title.appendChild(space);
        } else {
            const span = document.createElement('span');
            span.className = 'char';
            span.textContent = text[i];
            span.style.animationDelay = (0.3 + charIndex * 0.025) + 's';
            title.appendChild(span);
            charIndex++;
        }
    }

    // Typewriter subtitle
    const subtitle = document.getElementById('heroSubtitle');
    if (!subtitle) return;
    const subtitleText = 'Living Product Specification \u2014 Energy Action Fund \u00d7 empire | Co-Design Document';
    subtitle.style.opacity = '1';
    subtitle.style.minHeight = '1.5em';
    let si = 0;
    const cursor = document.createElement('span');
    cursor.className = 'typewriter-cursor';
    subtitle.appendChild(cursor);
    function typeNext() {
        if (si < subtitleText.length) {
            subtitle.insertBefore(document.createTextNode(subtitleText[si]), cursor);
            si++;
            requestAnimationFrame(() => setTimeout(typeNext, 28 + Math.random() * 20));
        } else {
            setTimeout(() => cursor.style.display = 'none', 2000);
        }
    }
    // Start typewriter after title animation completes
    setTimeout(typeNext, 300 + charIndex * 25 + 400);
})();

// ================================================================
// SECTION COLOR ACCENTS — scroll-responsive color system
// ================================================================
(function() {
    const sectionColorMap = {
        'section-00': 'var(--amber)',
        'executive-vision': 'var(--orange)',
        'essential-experiences': 'var(--purple)',
        'user-journey': 'var(--teal)',
        'section-04': 'var(--electric-blue)',
        'dual-model': 'var(--magenta)',
        'capabilities': 'var(--indigo)',
        'architecture': 'var(--teal)'
    };
    const root = document.documentElement;
    const accentObserver = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const color = sectionColorMap[entry.target.id];
                if (color) root.style.setProperty('--section-accent', color);
            }
        });
    }, { threshold: 0.3 });
    document.querySelectorAll('section[id]').forEach(s => accentObserver.observe(s));
})();
</script>
</body>
</html>
